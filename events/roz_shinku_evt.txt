namespace = roz_shinku_evt

country_event = {
    id = roz_shinku_evt.1
    is_triggered_only = yes
    title = "roz_shinku_evt.1.title"
    desc = "roz_shinku_evt.1.desc"
    picture = GFX_roz_evt_shoujonotsukurikata_vol1
    show_sound = roz_open_the_box
    trigger = {
        NOT = {
            has_country_flag = roz_shinku_story_start_flag
        }
    }
    immediate = {
        set_country_flag = roz_shinku_story_start_flag
    }
    option = {
        name = roz_shinku_evt.1.aa
        custom_tooltip = roz_shinku_evt.1.ct
    }
    after = {
        country_event = {
            id = roz_shinku_evt.2
        }
    }
}

country_event = {
    id = roz_shinku_evt.2
    is_triggered_only = yes
    title = "roz_shinku_evt.2.title"
    desc = "roz_shinku_evt.2.desc"
    picture = GFX_roz_evt_shoujonotsukurikata_shinku
    show_sound = event_hand_shake
    trigger = {
        has_country_flag = roz_leader_suigintou_get
    }
    option = {
        name = roz_shinku_evt.2.aa
    }
    option = {
        name = roz_shinku_evt.2.bb
    }
    after = {
        add_relic = roz_shuukan_shoujonotsukurikata_vol1
        begin_event_chain = { event_chain = roz_shoujonotsukurikata_chain target = root }
        enable_special_project = { name = roz_shoujonotsukurikata_project_1 owner = root }
        complete_special_project = { type = roz_shoujonotsukurikata_project_1 }
    }
}

###第二块零件
country_event = {
    id = roz_shinku_evt.20
    title = "roz_shinku_evt.20.title"
    desc = "roz_shinku_evt.20.desc"
    picture = GFX_evt_megastructure_construction
    show_sound = event_default
    is_triggered_only = yes
    trigger = {
        has_country_flag = roz_leader_suigintou_get
        has_technology = tech_mega_engineering
    }
    option = {
        name = roz_shinku_evt.20.aa
        custom_tooltip = roz_shinku_evt.20.ct
    }
    option = {
        name = roz_shinku_evt.20.bb
        custom_tooltip = roz_shinku_evt.20.ct
    }
    after = {
        add_relic = roz_shuukan_shoujonotsukurikata_vol2
        enable_special_project = { name = roz_shoujonotsukurikata_project_2 owner = root }
    }
}

###第三块零件
country_event = {
    id = roz_shinku_evt.30
    title = "roz_shinku_evt.30.title"
    desc = "roz_shinku_evt.30.desc"
    picture = GFX_evt_psionics
    show_sound = event_psionic
    is_triggered_only = yes
    trigger = {
        has_country_flag = roz_leader_suigintou_get
        OR = {
            has_technology = tech_psionic_theory
            is_active_resolution = resolution_galacticstudies_extradimensional_experimentation
            has_relic = r_zro_crystal
            has_relic = r_roz_stasis_field
        }
    }
    option = {
        name = roz_shinku_evt.30.aa
        custom_tooltip = roz_shinku_evt.30.ct
    }
    option = {
        name = roz_shinku_evt.30.bb
        custom_tooltip = roz_shinku_evt.30.ct
    }
    after = {
        add_relic = roz_shuukan_shoujonotsukurikata_vol3
        enable_special_project = { name = roz_shoujonotsukurikata_project_3 owner = root }
    }
}

###第四块零件
country_event = {
    id = roz_shinku_evt.40
    title = "roz_shinku_evt.40.title"
    desc = "roz_shinku_evt.40.desc"
    picture = GFX_evt_roz_shoujonotsukurikata_vol4
    is_triggered_only = yes
    show_sound = event_first_contact_molluscoid
    trigger = {
        has_country_flag = roz_leader_suigintou_get
    }
    option = {
        name = roz_shinku_evt.40.aa
        custom_tooltip = roz_shinku_evt.40.aa.ct
    }
    option = {
        name = roz_shinku_evt.40.bb
        custom_tooltip = roz_shinku_evt.40.bb.ct
    }
    after = {
        add_relic = roz_shuukan_shoujonotsukurikata_vol4
        enable_special_project = { name = roz_shoujonotsukurikata_project_4 owner = root }
    }
}

###第五块零件，是否联动狐狐
country_event = {
    id = roz_shinku_evt.50
    title = "roz_shinku_evt.50.title"
    desc = "roz_shinku_evt.50.desc"
    picture = GFX
    is_triggered_only = yes
    trigger = {
        has_country_flag = roz_leader_suigintou_get
        KZ_VOY_MOD = no
    }
    option = {
        name = roz_shinku_evt.50.aa
        custom_tooltip = roz_shinku_evt.50.aa.ct
    }

    after = {  #test
        add_relic = roz_shuukan_shoujonotsukurikata_vol5
        enable_special_project = { name = roz_shoujonotsukurikata_project_5 owner = root }
    }
}


###第六块零件
country_event = {
    id = roz_shinku_evt.60
    title = "roz_shinku_evt.60.title"
    desc = "roz_shinku_evt.60.desc"
    picture = GFX_evt_astral_rift_ancient_battlegrounds
    show_sound = event_sensor_ping
    is_triggered_only = yes
    trigger = {
        has_country_flag = roz_leader_suigintou_get
        has_country_flag = roz_kirakishou_get
    }
    option = {
        name = roz_shinku_evt.60.aa
        custom_tooltip = roz_shinku_evt.60.aa.ct
    }
    option = {
        name = roz_shinku_evt.60.bb
        custom_tooltip = roz_shinku_evt.60.bb.ct
    }
    after = {
        add_relic = roz_shuukan_shoujonotsukurikata_vol6
        enable_special_project = { name = roz_shoujonotsukurikata_project_6 owner = root }
    }
}

###第七块零件
country_event = {
    id = roz_shinku_evt.70
    title = "roz_shinku_evt.70.title"
    desc = "roz_shinku_evt.70.desc"
    picture = GFX_evt_roz_shoujonotsukurikata_vol7
    is_triggered_only = yes
    show_sound = event_ancient_drone
    trigger = {
        has_country_flag = roz_leader_suigintou_get
        check_variable = { which = roz_leader_aft_suigintou_reduced_score value >= 10 }
    }
    option = {
        name = roz_shinku_evt.70.aa
    }
    option = {
        name = roz_shinku_evt.70.bb
    }
    after = { country_event = { id = roz_shinku_evt.71 } }
}

country_event = {
    id = roz_shinku_evt.71
    title = "roz_shinku_evt.71.title"
    desc = "roz_shinku_evt.71.desc"
    picture = GFX_evt_roz_shoujonotsukurikata_vol7
    is_triggered_only = yes
    show_sound = research_click_01
    trigger = {
        has_country_flag = roz_leader_suigintou_get
    }
    option = {
        name = roz_shinku_evt.71.aa
        custom_tooltip = roz_shinku_evt.71.aa.ct
    }
    option = {
        name = roz_shinku_evt.71.bb
        custom_tooltip = roz_shinku_evt.71.bb.ct
    }
    after = {
        set_country_flag = roz_allow_date_suigintou
        add_relic = roz_shuukan_shoujonotsukurikata_vol7
        enable_special_project = { name = roz_shoujonotsukurikata_project_7 owner = root }
    }
}

###第八块零件
country_event = {
    id = roz_shinku_evt.80
    title = "roz_shinku_evt.80.title"
    desc = "roz_shinku_evt.80.desc"
    picture = GFX_evt_roz_shoujonotsukurikata_vol8_1
    is_triggered_only = yes
    show_sound = research_click_01
    trigger = {
        has_country_flag = roz_leader_suigintou_get
        check_variable = { which = roz_leader_aft_suigintou_reduced_score value >= 25 }
    }
    option = {
        name = roz_shinku_evt.80.aa
    }
    option = {
        name = roz_shinku_evt.80.bb
    }
    after = { country_event = { id = roz_shinku_evt.81 } }
}

country_event = {
    id = roz_shinku_evt.81
    title = "roz_shinku_evt.81.title"
    desc = "roz_shinku_evt.81.desc"
    picture = GFX_evt_roz_shoujonotsukurikata_vol8_2
    is_triggered_only = yes
    show_sound = research_click_01
    trigger = {
        has_country_flag = roz_leader_suigintou_get
    }
    option = {
        name = roz_shinku_evt.81.aa
        custom_tooltip = roz_shinku_evt.81.aa.ct
    }
    option = {
        name = roz_shinku_evt.81.bb
        custom_tooltip = roz_shinku_evt.81.bb.ct
    }
    after = {
        add_relic = roz_shuukan_shoujonotsukurikata_vol8
        enable_special_project = { name = roz_shoujonotsukurikata_project_8 owner = root }
    }
}

###第⑨块零件
country_event = {
    id = roz_shinku_evt.90
    title = "roz_shinku_evt.90.title"
    desc = "roz_shinku_evt.90.desc"
    diplomatic = yes
    is_triggered_only = yes
    picture_event_data = {
        portrait = event_target:ge_leader
        room = ge_sgt_main_room
    }
    trigger = {
        has_country_flag = roz_leader_suigintou_get
        check_variable = { which = roz_leader_aft_suigintou_reduced_score value >= 35 }
        NOR = {
            has_country_flag = ge_nfield_diplomacy_activated
            has_country_flag = ge_sgt_busy
            has_country_flag = roz_shuukan_vol9_flag
        }
        from = {
            is_same_value = event_target:roz_suigintou_global_country@root
            NOR = {
                is_same_value = event_target:roz_kirakishou_global_country@root
                is_same_value = event_target:roz_shinku_global_country@root
            }
        }
    }
    immediate = {
        get_ge_leader_target = {
            flag = roz_suigintou_flag
        }
        set_country_flag = roz_shuukan_vol9_flag
        set_country_flag = ge_nfield_diplomacy_activated
    }
    option = {
        name = roz_shinku_evt.90.aa
        country_event = { id = roz_shinku_evt.91 }
    }
}

country_event = {
    id = roz_shinku_evt.91
    title = "roz_shinku_evt.91.title"
    desc = {
        trigger = { has_country_flag = roz_shinku_evt_91_aa }
        text = roz_shinku_evt.91.aa.res
    }
    desc = {
        trigger = { has_country_flag = roz_shinku_evt_91_bb }
        text = roz_shinku_evt.91.bb.res
    }
    desc = "roz_shinku_evt.91.desc"
    diplomatic = yes
    picture_event_data = {
        portrait = event_target:ge_leader
        room = ge_sgt_main_room
    }
    is_triggered_only = yes
    trigger = {
        has_country_flag = roz_leader_suigintou_get
    }
    immediate = {
        get_ge_leader_target = {
            flag = roz_suigintou_flag
        }
    }
    option = {
        name = roz_shinku_evt.91.aa
        #response_text = roz_shinku_evt.91.aa.res
        #is_dialog_only = yes
        trigger = { NOR = { has_country_flag = roz_shinku_evt_91_aa has_country_flag = roz_shinku_evt_91_bb } }
        hidden_effect = { set_country_flag = roz_shinku_evt_91_aa country_event = { id = roz_shinku_evt.91 } }
    }
    option = {
        name = roz_shinku_evt.91.aa.res.option1
        trigger = {  has_country_flag = roz_shinku_evt_91_aa }
        hidden_effect = { hidden_effect = { country_event = { id = roz_shinku_evt.95 } remove_country_flag = roz_shinku_evt_91_aa } }
    }

    option = {
        name = roz_shinku_evt.91.bb
        #response_text = roz_shinku_evt.91.bb.res
        #is_dialog_only = yes
        trigger = { NOR = { has_country_flag = roz_shinku_evt_91_bb has_country_flag = roz_shinku_evt_91_aa } }
        hidden_effect = { set_country_flag = roz_shinku_evt_91_bb country_event = { id = roz_shinku_evt.91 } }
    }
    option = {
        name = roz_shinku_evt.91.bb.res.option1
        trigger = {  has_country_flag = roz_shinku_evt_91_bb }
        hidden_effect = { hidden_effect = { country_event = { id = roz_shinku_evt.95 } remove_country_flag = roz_shinku_evt_91_bb } }
    }
    option = {
        name = roz_shinku_evt.91.bb.res.option2
        trigger = {  has_country_flag = roz_shinku_evt_91_bb }
        hidden_effect = { hidden_effect = { country_event = { id = roz_shinku_evt.95 } remove_country_flag = roz_shinku_evt_91_bb } }
    }

    option = {
        name = roz_shinku_evt.91.cc
        custom_tooltip = roz_shinku_evt.91.cc_ct
        trigger = { NOR = { has_country_flag = roz_shinku_evt_91_aa has_country_flag = roz_shinku_evt_91_bb } }
        hidden_effect = { country_event = { id = roz_shinku_evt.95 } }
    }

    #after = { hidden_effect = { country_event = { id = roz_shinku_evt.95 } } }
}

country_event = {
    id = roz_shinku_evt.95
    title = "roz_shinku_evt.95.title"
    desc = "roz_shinku_evt.95.desc"
    picture = GFX_evt_roz_shoujonotsukurikata_vol9
    is_triggered_only = yes
    show_sound = research_click_01
    trigger = {
        has_country_flag = roz_leader_suigintou_get
    }
    option = {
        name = roz_shinku_evt.95.aa
    }
    option = {
        name = roz_shinku_evt.95.bb
    }
    after = { country_event = { id = roz_shinku_evt.96 } }
}

country_event = {
    id = roz_shinku_evt.96
    title = "roz_shinku_evt.96.title"
    desc = "roz_shinku_evt.96.desc"
    picture = GFX_evt_roz_shoujonotsukurikata_vol9
    is_triggered_only = yes
    show_sound = research_click_01
    trigger = {
        has_country_flag = roz_leader_suigintou_get
    }
    option = {
        name = roz_shinku_evt.96.aa
        custom_tooltip = roz_shinku_evt.96.aa.ct
    }
    option = {
        name = roz_shinku_evt.96.bb
        custom_tooltip = roz_shinku_evt.96.bb.ct
    }
    after = {
        add_relic = roz_shuukan_shoujonotsukurikata_vol9
        remove_country_flag = ge_nfield_diplomacy_activated
        enable_special_project = { name = roz_shoujonotsukurikata_project_9 owner = root }
    }
}

###第十块零件
country_event = {
    id = roz_shinku_evt.100
    title = "roz_shinku_evt.100.title"
    desc = "roz_shinku_evt.100.desc"
    picture = GFX_evt_roz_scientific_exhibition
    is_triggered_only = yes
    show_sound = research_click_01
    trigger = {
        has_country_flag = roz_leader_suigintou_get
    }
    option = {
        name = roz_shinku_evt.100.aa
        custom_tooltip = roz_shinku_evt.100.aa.ct
    }
    option = {
        name = roz_shinku_evt.100.bb
        custom_tooltip = roz_shinku_evt.100.bb.ct
    }
    after = {
        add_relic = roz_shuukan_shoujonotsukurikata_vol10
        enable_special_project = { name = roz_shoujonotsukurikata_project_10 owner = root }
    }
}

###少女的制作方法
#完成第二次制作
country_event = {
    id = roz_shinku_evt.110
    title = "roz_shinku_evt.110.title"
    desc = "roz_shinku_evt.110.desc"
    picture = GFX_evt_roz_the_box
    is_triggered_only = yes
    trigger = {
        has_country_flag = roz_leader_suigintou_get
    }
    option = {
        name = roz_shinku_evt.110.aa
        custom_tooltip = roz_shinku_evt.110.aa.ct
    }
    after = {
        remove_relic = roz_shuukan_shoujonotsukurikata_vol1
        roz_remove_shinkureilc_effect = yes
        add_relic = roz_shinku's_body_assembly_stage_1
        add_event_chain_counter = { event_chain = roz_shoujonotsukurikata_chain amount = 1 counter = roz_shinku_progress }
    }
}

#第三次到第九次完成制作
country_event = {
    id = roz_shinku_evt.120
    title = "roz_shinku_evt.120.title"
    desc = "roz_shinku_evt.120.desc"
    picture = GFX_evt_roz_shoujonotsukurikata_part
    is_triggered_only = yes
    trigger = {
        has_country_flag = roz_leader_suigintou_get
        NOT = { has_country_flag = roz_kirakishou_get }
    }
    option = {
        name = roz_shinku_evt.120.aa
        allow = { NOT = { has_active_event = { roz_shinku_evt.110 } } }
        hidden_effect = {
            remove_country_flag = roz_shoujonotsukurikata_project_3_complete
            remove_relic = roz_shuukan_shoujonotsukurikata_vol3
        }
    }
    after = {
        #roz_remove_shinkureilc_effect = yes
        country_event = { id = roz_shinku_evt.121 }
        add_event_chain_counter = { event_chain = roz_shoujonotsukurikata_chain amount = 1 counter = roz_shinku_progress }
    }
}

country_event = {
    id = roz_shinku_evt.121
    hide_window = yes
    is_triggered_only = yes
    trigger = { NOT = { has_relic = roz_shinku's_body_assembly_stage_2 } }
    immediate = {
        if = {
            limit = { check_variable = { which = roz_shinku_progress_count value >= 7 } has_relic = roz_shinku's_body_assembly_stage_1 }
            remove_relic = roz_shinku's_body_assembly_stage_1
            add_relic = roz_shinku's_body_assembly_stage_2
        }
    }
}
country_event = {
    id = roz_shinku_evt.123
    is_triggered_only = yes
    base = roz_shinku_evt.120
}

country_event = {
    id = roz_shinku_evt.130
    title = "roz_shinku_evt.130.title"
    desc = "roz_shinku_evt.130.desc"
    picture = GFX_evt_roz_shoujonotsukurikata_part
    is_triggered_only = yes
    trigger = {
        has_country_flag = roz_leader_suigintou_get
        has_country_flag = roz_kirakishou_get
    }
    option = {
        name = roz_shinku_evt.130.aa
        allow = { NOT = { has_active_event = { roz_shinku_evt.110 } } }
    }
    after = {
        roz_remove_shinkureilc_effect = yes
        country_event = { id = roz_shinku_evt.131 }
        add_event_chain_counter = { event_chain = roz_shoujonotsukurikata_chain amount = 1 counter = roz_shinku_progress }
    }
}

country_event = {
    id = roz_shinku_evt.131
    is_triggered_only = yes
    hide_window = yes
    base = roz_shinku_evt.121
}

#最后一块组件制作完成
country_event = {
    id = roz_shinku_evt.140
    title = "roz_shinku_evt.140.title"
    desc = "roz_shinku_evt.140.desc"
    show_sound = event_celebration
    picture = GFX_evt_roz_shoujonotsukurikata_end
    is_triggered_only = yes
    trigger = {
        has_country_flag = roz_leader_suigintou_get
    }
    option = {
        name = roz_shinku_evt.140.aa
        allow = { NOT = { has_active_event = { roz_shinku_evt.110 roz_shinku_evt.120 roz_shinku_evt.130 } } }
    }
    after = {
        roz_remove_shinkureilc_effect = yes
        add_event_chain_counter = { event_chain = roz_shoujonotsukurikata_chain amount = 1 counter = roz_shinku_progress }
        add_relic = roz_shinku's_body_assembly_stage_3
        remove_relic = roz_shinku's_body_assembly_stage_2
        country_event = { id = roz_shinku_evt.401 days = 30 }
    }
}

#####完成局势“周刊《少女的制作方法》”，小纯通讯

# country_event = {
#     id = roz_shinku_evt.400
#     title = "roz_shinku_evt.400.title"
#     desc = "roz_shinku_evt.400.desc"
#     picture = GFX_evt_roz_heart_lost_doll
#     show_sound = resources_capped
#     is_triggered_only = yes
#     trigger = {
#         is_ai = no
#     }
#     immediate = {  }
#     option = {
#         name = roz_shinku_evt.400.aa
#     }
# }

country_event = {
    id = roz_shinku_evt.401
    title = "roz_shinku_evt.401.title"
    desc = "roz_shinku_evt.401.desc"
    picture = GFX_evt_roz_junn_phone_1
    show_sound = event_sensor_ping
    is_triggered_only = yes
    trigger = {
        check_variable = { which = roz_shinku_progress_count value >= 10  }
    }
    immediate = {

    }
    option = {
        name = roz_shinku_evt.401.aa
        country_event = {
            id = roz_shinku_evt.402
        }
    }
}

country_event = {
    id = roz_shinku_evt.402
    title = "roz_shinku_evt.402.title"
    desc = "roz_shinku_evt.402.desc"
    picture = GFX_evt_roz_junn_phone_2
    show_sound = event_announcement
    is_triggered_only = yes
    trigger = {
        is_ai = no
    }
    option = {
        name = roz_shinku_evt.402.aa
        #custom_tooltip = roz_shinku_evt.402.ct
        enable_special_project = {
            name = roz_shinku_phone_of_junn_analysis
            owner = root
            location = root.capital_star
        }
    }
}

country_event = {
    id = roz_shinku_evt.403
    title = "roz_shinku_evt.403.title"
    desc = "roz_shinku_evt.403.desc"
    is_triggered_only = yes
    diplomatic = yes
    show_sound = event_alien_signal
    picture_event_data = {
         room = roz_junn_room
    }
    trigger = {
        #has_country_flag = roz_leader_suigintou_get
        is_ai = no
    }
    option = {
        name = roz_shinku_evt.403.aa
        response_text = roz_shinku_evt.403.aa.res
        hidden_effect = { set_country_flag = roz_evt_temp_flag_1 }
        allow = { hidden_trigger = { NOT = { has_country_flag = roz_evt_temp_flag_1 } } }
        is_dialog_only = yes
    }
    option = {
        name = roz_shinku_evt.403.bb
        response_text = roz_shinku_evt.403.bb.res
        hidden_effect = { set_country_flag = roz_evt_temp_flag_2 }
        allow = { hidden_trigger = { NOT = { has_country_flag = roz_evt_temp_flag_2 } } }
        is_dialog_only = yes
    }
    option = {
        name = roz_shinku_evt.403.cc
        response_text = roz_shinku_evt.403.cc.res
        hidden_effect = { set_country_flag = roz_evt_temp_flag_3 }
        allow = { hidden_trigger = { NOT = { has_country_flag = roz_evt_temp_flag_3 } } }
        is_dialog_only = yes
    }
    option = {
        name = roz_shinku_evt.403.dd
        response_text = roz_shinku_evt.403.dd.res
        hidden_effect = { set_country_flag = roz_evt_temp_flag_4 }
        allow = { hidden_trigger = { NOT = { has_country_flag = roz_evt_temp_flag_4 } } }
        is_dialog_only = yes
    }
    option = {
        name = roz_shinku_evt.403.ee
        response_text = roz_shinku_evt.403.ee.res
        hidden_effect = { set_country_flag = roz_evt_temp_flag_5 }
        allow = { hidden_trigger = { NOT = { has_country_flag = roz_evt_temp_flag_5 } } }
        is_dialog_only = yes
    }
    option = {
        name = roz_shinku_evt.403.ff
        response_text = roz_shinku_evt.403.ff.res
        hidden_effect = { set_country_flag = roz_evt_temp_flag_6 }
        allow = { hidden_trigger = { NOT = { has_country_flag = roz_evt_temp_flag_6 } } }
        is_dialog_only = yes
    }
    option = {
        name = roz_shinku_evt.403.gg
        default_hide_option = yes
        custom_tooltip = roz_shinku_evt.403.gg.ct
        add_resource = {
            unity = 1000
        }
        begin_event_chain = { event_chain = roz_wake-up_shinku_chain }
        add_event_chain_counter = { event_chain = roz_wake-up_shinku_chain counter = roz_wake-up_shinku_chain_progress amount = 2 }
        hidden_effect = { start_situation = { type = roz_awaken_of_shinku_1_acknowledge_border } }
    }
    after = {
        hidden_effect = {
            roz_junn_country_create = yes
            remove_country_flag = roz_evt_temp_flag_1
            remove_country_flag = roz_evt_temp_flag_2
            remove_country_flag = roz_evt_temp_flag_3
            remove_country_flag = roz_evt_temp_flag_4
            remove_country_flag = roz_evt_temp_flag_5
            remove_country_flag = roz_evt_temp_flag_6
        }
        #start_situation = { type = roz_awaken_of_shinku_1_acknowledge_border }
    }
}


##############################
#局势：解析蔷薇圣母
# #局势结束事件
country_event = {
    id = roz_shinku_evt.404
    is_triggered_only = yes
    title = "roz_shinku_evt.404.title"
    desc = "roz_shinku_evt.404.desc"
    picture = GFX_evt_roz_acknowledge_border
    trigger = {
        from = {
            is_situation_type = roz_awaken_of_shinku_1_acknowledge_border
        }
    }
    immediate = {
        set_country_flag = roz_SK_1_kxbj_complete
    }
    option = {
        name = roz_shinku_evt.404.aa
        add_resource = {
            physics_research = 1000
            engineering_research = 1000
            society_research = 1000
        }
    }
    option = {
        name = roz_shinku_evt.404.bb
        add_resource = {
            sr_rosa_mystica = -1
            sr_rosa_mystica = 1
        }
    }
    after = {
        custom_tooltip = roz_shinku_evt.404.ct
        add_modifier = {
            modifier = roz_SK_ec_boundaries_of_science_frustrated
            months = 3
        }
    }
}

situation_event = {
    id = roz_shinku_evt.410
    is_triggered_only = yes
    hide_window = yes
    trigger = { NOT = { has_situation_flag = roz_awaken_of_shinku_1_acknowledge_border_1_cyclic } }
    immediate = {
        switch = {
            trigger = current_situation_approach
            roz_awaken_of_shinku_1_acknowledge_border_1_approach = {
                set_timed_situation_flag = { flag = roz_awaken_of_shinku_1_acknowledge_border_1_cyclic months = 3 }
            }
            roz_awaken_of_shinku_1_acknowledge_border_2_approach = {
                set_timed_situation_flag = { flag = roz_awaken_of_shinku_1_acknowledge_border_1_cyclic months = 6 }
            }
            roz_awaken_of_shinku_1_acknowledge_border_3_approach = {
                set_timed_situation_flag = { flag = roz_awaken_of_shinku_1_acknowledge_border_1_cyclic months = 12 }
            }
            roz_awaken_of_shinku_1_acknowledge_border_4_approach = {
                set_situation_flag = roz_awaken_of_shinku_1_acknowledge_border_1_cyclic
            }
        }
        random_list = {
            1 = { modifier = { factor = 0 owner = { has_relic = r_roz_doll_Annabelle } } situation_event = { id = roz_shinku_evt.411 } }
            5 = { situation_event = { id = roz_shinku_evt.412 } }
            5 = { situation_event = { id = roz_shinku_evt.413 } }
            5 = { situation_event = { id = roz_shinku_evt.414 } }
            2 = { modifier = { factor = 0 owner = { NOT = { has_modifier = roz_rosa_analysis_industrial } } } situation_event = { id = roz_shinku_evt.415 } }
            2 = { modifier = { factor = 0 owner = { NOT = { has_modifier = roz_rosa_analysis_research } } } situation_event = { id = roz_shinku_evt.416 } }
            2 = { modifier = { factor = 0 owner = { NOT = { has_modifier = roz_rosa_analysis_military } } } situation_event = { id = roz_shinku_evt.417 } }
            5 = { modifier = { factor = 0 owner = { NOT = { has_modifier = roz_rosa_analysis_temporary } } } situation_event = { id = roz_shinku_evt.418 } }
            6 = { situation_event = { id = roz_shinku_evt.419 } }
            1 = { modifier = { factor = 0 owner = { NOT = { has_modifier = roz_rosa_analysis_research_fault } } } situation_event = { id = roz_shinku_evt.420 } }
            4 = { situation_event = { id = roz_shinku_evt.421 } }
            4 = { situation_event = { id = roz_shinku_evt.422 } }
            2 = { modifier = { factor = 0 NOT = { has_situation_flag = roz_rosa_analysis_negative_flag } } situation_event = { id = roz_shinku_evt.423 } }
            1= {  }
        }
        reroll_random = yes
    }
}

# #月度事件池
situation_event = {
    id = roz_shinku_evt.411
    is_triggered_only = yes
    title = "roz_shinku_evt.411.title"
    desc = "roz_shinku_evt.411.desc"
    picture = GFX_evt_roz_annabelle
    trigger = {
        owner = { NOT = { has_relic = r_roz_doll_Annabelle } }
    }
    option = {
        name = roz_shinku_evt.411.aa
        owner = {
            add_relic = r_roz_doll_Annabelle
            add_resource = {
                unity = -500
            }
        }
    }
}

situation_event = {
    id = roz_shinku_evt.412
    is_triggered_only = yes
    title = "roz_shinku_evt.412.title"
    desc = "roz_shinku_evt.412.desc"
    picture = GFX_evt_roz_bright_new_world
    trigger = {
        owner = { is_ai = no }
    }
    option = {
        name = roz_shinku_evt.412.aa
        owner = {
            random_list = {
                3 = {
                    add_monthly_resource_mult = {
                        resource = alloys
                        value = 3
                    }
                }
                3 = {
                    add_monthly_resource_mult = {
                        resource = consumer_goods
                        value = 3
                    }
                }
                2 = {
                    add_monthly_resource_mult = {
                        resource =food
                        value = 4
                    }
                }
                2 = {
                    add_monthly_resource_mult = {
                        resource = energy
                        value = 5
                    }
                }
                2 = {
                    add_monthly_resource_mult = {
                        resource = minerals
                        value = 4
                    }
                }
                2 = {
                    add_monthly_resource_mult = {
                        resource = minor_artifacts
                        value = 3
                    }
                }

            }
        }
    }
}

situation_event = {
    id = roz_shinku_evt.422
    is_triggered_only = yes
    title = "roz_shinku_evt.422.title"
    desc = "roz_shinku_evt.422.desc"
    picture = GFX_evt_astral_rift_genesis_2
    show_sound = event_lootbox_good
    trigger = {
        owner = { is_ai = no }
    }
    option = {
        name = roz_shinku_evt.422.aa
        owner = {
            random_list = {
                2 = {
                    add_monthly_resource_mult = {
                        resource = physics_research
                        value = 5
                    }
                }
                2 = {
                    add_monthly_resource_mult = {
                        resource = engineering_research
                        value = 5
                    }
                }
                2 = {
                    add_monthly_resource_mult = {
                        resource = society_research
                        value = 5
                    }
                }
            }
        }
    }
}

situation_event = {
    id = roz_shinku_evt.413
    is_triggered_only = yes
    title = "roz_shinku_evt.413.title"
    desc = "roz_shinku_evt.413.desc"
    picture = GFX_evt_roz_scientific_exhibition
    show_sound = event_galactic_community
    trigger = {
        owner = { is_ai = no }
    }
    option = {
        name = roz_shinku_evt.413.aa
        owner = {
            add_monthly_resource_mult = {
                resource = unity
                value = 5
            }
        }
    }
}

situation_event = {
    id = roz_shinku_evt.414
    is_triggered_only = yes
    title = "roz_shinku_evt.414.title"
    desc = "roz_shinku_evt.414.desc"
    picture = GFX_evt_roz_rozen_party
    show_sound = event_factions
    trigger = {
        owner = { is_ai = no }
    }
    option = {
        name = roz_shinku_evt.414.aa
        owner = {
            add_monthly_resource_mult = {
                resource = influence
                value = 4
            }
        }
    }
}

situation_event = {
    id = roz_shinku_evt.415
    is_triggered_only = yes
    title = "roz_shinku_evt.415.title"
    desc = "roz_shinku_evt.415.desc"
    picture = GFX_evt_caravaneers
    show_sound = sfx_caravaneer_cargo_ship_idle
    trigger = {
        owner = { NOT = { has_modifier = roz_rosa_analysis_industrial } }
    }
    option = {
        name = roz_shinku_evt.415.aa
        owner = {
            add_modifier = {
                modifier = roz_rosa_analysis_industrial
            }
        }
    }
}

situation_event = {
    id = roz_shinku_evt.416
    is_triggered_only = yes
    title = "roz_shinku_evt.416.title"
    desc = "roz_shinku_evt.416.desc"
    picture = GFX_evt_cyberization_2
    show_sound = event_cityscape
    trigger = {
        owner = { NOT = { has_modifier = roz_rosa_analysis_research } }
    }
    option = {
        name = roz_shinku_evt.416.aa
        owner = {
            add_modifier = {
                modifier = roz_rosa_analysis_research
            }
        }
    }
}

situation_event = {
    id = roz_shinku_evt.417
    is_triggered_only = yes
    title = "roz_shinku_evt.417.title"
    desc = "roz_shinku_evt.417.desc"
    picture = GFX_evt_roz_spaceship_bridge
    show_sound = event_ship_bridge
    trigger = {
        owner = { NOT = { has_modifier = roz_rosa_analysis_military } }
    }
    option = {
        name = roz_shinku_evt.417.aa
        owner = {
            add_modifier = {
                modifier = roz_rosa_analysis_military
            }
        }
    }
}

situation_event = {
    id = roz_shinku_evt.418
    is_triggered_only = yes
    title = "roz_shinku_evt.418.title"
    desc = "roz_shinku_evt.418.desc"
    picture = GFX_evt_roz_industrial_factory
    show_sound = event_engineered_evolution
    trigger = {
        owner = { NOT = { has_modifier = roz_rosa_analysis_temporary } }
    }
    option = {
        name = roz_shinku_evt.418.aa
        switch = {
            trigger = current_situation_approach
            roz_awaken_of_shinku_1_acknowledge_border_1_approach = {
                owner = { add_modifier = { modifier = roz_rosa_analysis_temporary months = 3 } }
            }
            roz_awaken_of_shinku_1_acknowledge_border_2_approach = {
                owner = { add_modifier = { modifier = roz_rosa_analysis_temporary months = 6 } }
            }
            roz_awaken_of_shinku_1_acknowledge_border_3_approach = {
                owner = { add_modifier = { modifier = roz_rosa_analysis_temporary months = 12 } }
            }
            roz_awaken_of_shinku_1_acknowledge_border_4_approach = {

            }
        }
    }
}

situation_event = {
    id = roz_shinku_evt.419
    is_triggered_only = yes
    title = "roz_shinku_evt.419.title"
    desc = "roz_shinku_evt.419.desc"
    picture = GFX_evt_smugglers_in_bar
    show_sound = event_non-empire_contact
    trigger = {
        always = yes
    }
    option = {
        name = roz_shinku_evt.419.aa
    }
}

situation_event = {
    id = roz_shinku_evt.420
    is_triggered_only = yes
    title = "roz_shinku_evt.420.title"
    desc = "roz_shinku_evt.420.desc"
    picture = GFX_evt_spy_network
    show_sound = event_power_down
    trigger = {
       owner = { NOT = { has_modifier = roz_rosa_analysis_research_fault } }
    }
    option = {
        name = roz_shinku_evt.420.aa
        switch = {
            trigger = current_situation_approach
            roz_awaken_of_shinku_1_acknowledge_border_1_approach = {
                owner = { add_modifier = { modifier = roz_rosa_analysis_research_fault months = 3 } }
            }
            roz_awaken_of_shinku_1_acknowledge_border_2_approach = {
                owner = { add_modifier = { modifier = roz_rosa_analysis_research_fault months = 6 } }
            }
            roz_awaken_of_shinku_1_acknowledge_border_3_approach = {
                owner = { add_modifier = { modifier = roz_rosa_analysis_research_fault months = 12 } }
            }
            roz_awaken_of_shinku_1_acknowledge_border_4_approach = {

            }
        }
    }
}

situation_event = {
    id = roz_shinku_evt.421
    is_triggered_only = yes
    title = "roz_shinku_evt.421.title"
    desc = "roz_shinku_evt.421.desc"
    picture = GFX_solar_storm
    show_sound = event_power_down
    trigger = {
        owner = { is_ai = no }
    }
    option = {
        name = roz_shinku_evt.421.aa
        owner = {
            add_resource = {
                unity = -1000
                influence = -50
                society_research = -1000
            }
        }
    }
}

situation_event = {
    id = roz_shinku_evt.423
    is_triggered_only = yes
    title = "roz_shinku_evt.423.title"
    desc = "roz_shinku_evt.423.desc"
    picture = GFX_evt_origin_stormchasers_event_progress
    show_sound = event_laboratory_sound
    trigger = {
        owner = { NOT = { has_country_flag = roz_rosa_analysis_negative_flag } }
    }
    immediate = {
        switch = {
            trigger = current_situation_approach
            roz_awaken_of_shinku_1_acknowledge_border_1_approach = {
                set_timed_situation_flag = { flag = roz_rosa_analysis_negative_flag months = 3 }
            }
            roz_awaken_of_shinku_1_acknowledge_border_2_approach = {
                set_timed_situation_flag = { flag = roz_rosa_analysis_negative_flag months = 6 }
            }
            roz_awaken_of_shinku_1_acknowledge_border_3_approach = {
                set_timed_situation_flag = { flag = roz_rosa_analysis_negative_flag months = 12 }
            }
            roz_awaken_of_shinku_1_acknowledge_border_4_approach = {
                set_situation_flag = roz_rosa_analysis_negative_flag
            }
        }
    }
    option = {
        name = roz_shinku_evt.423.aa
        custom_tooltip = roz_shinku_evt.423.ct
    }
}







#####################
#二阶段-卷土重来事件链
#在局势“解析蔷薇圣母”进行到三阶段时的1-60天内触发（一阶段进行到一半的时候……）
country_event = {
    id = roz_shinku_evt.425
    is_triggered_only = yes
    title = "roz_shinku_evt.425.title"
    desc = "roz_shinku_evt.425.desc"
    show_sound = event_red_alert
    picture_event_data = {
        room = no_video_feed_room
    }
    diplomatic = yes
    trigger = {
        is_ai = no
    }
    immediate = {
        set_country_flag = roz_junn_dip_locked
    }
    option = {
        name = roz_shinku_evt.425.aa
        response_text = roz_shinku_evt.425.aa.res
        is_dialog_only = yes
    }
    option = {
        name = roz_shinku_evt.425.bb
        country_event = { id = roz_shinku_evt.430 days = 1 }
    }
}

country_event = {
    #2条分支路线
    id = roz_shinku_evt.430
    is_triggered_only = yes
    title = "roz_shinku_evt.430.title"
    desc = "roz_shinku_evt.430.desc"
    picture_event_data = {
        room = galactic_custodian_room
    }
    show_sound = event_conversation
    diplomatic = yes
    trigger = {
        is_ai = no
    }
    option = {
        name = roz_shinku_evt.430.aa
        custom_tooltip = roz_shinku_evt.430.aa.ct
        country_event = {
            id = roz_shinku_evt.431
            days = 3
        }
    }
    option = {
        name = roz_shinku_evt.430.bb
        custom_tooltip = roz_shinku_evt.430.bb.ct
        allow = {
            resource_stockpile_compare = {
                resource = sr_rosa_mystica
                value >= 5000
            }
            resource_stockpile_compare = {
                resource = energy
                value >= 50000
            }
        }
        country_event = {
            id = roz_shinku_evt.434
            days = 1
        }
        hidden_effect = {
            set_country_flag = roz_unholy_invasion_defend_proj_conservative
        }
    }
    after = {
        hidden_effect = {
            country_event = {
                id = roz_shinku_evt.4301
                days = 15
            }
        }
    }
}

#一阶段科学边界局势开始加速
country_event = {
    id = roz_shinku_evt.4301
    is_triggered_only = yes
    title = "roz_shinku_evt.4301.title"
    desc = "roz_shinku_evt.4301.desc"
    show_sound = event_yellow_alert
    picture = GFX_evt_cosmic_storms_broadcast_hacking
    trigger = {
        any_situation = {
            is_situation_type = roz_awaken_of_shinku_1_acknowledge_border
            OR = {
                current_stage = roz_awaken_of_shinku_1_acknowledge_border_stage_3
                current_stage = roz_awaken_of_shinku_1_acknowledge_border_stage_4
                current_stage = roz_awaken_of_shinku_1_acknowledge_border_stage_end
            }
        }
    }
    option = {
        name = roz_shinku_evt.4301.aa
        custom_tooltip = roz_shinku_evt.4301.ct
        hidden_effect = {
            set_country_flag = roz_SK_1_kxbj_accelerate
        }
    }
}

###卷土重来：选项一
country_event = {
    id = roz_shinku_evt.431
    is_triggered_only = yes
    title = "roz_shinku_evt.431.title"
    desc = "roz_shinku_evt.431.desc"
    show_sound = event_ship_thrusters
    picture = GFX_evt_astral_rift_crystal_3
    trigger = {
        is_ai = no
    }
    location = event_target:roz_n_field_site_target@root
    option = {
        name = roz_shinku_evt.431.aa
        add_monthly_resource_mult = {
            value = 3
            resource = unity
        }
        add_monthly_resource_mult = {
            value = 1
            resource = influence
        }
    }
    option = {
        name = roz_shinku_evt.431.bb
        add_monthly_resource_mult = {
            value = 2
            resource = alloys
        }
    }
    after = {
        hidden_effect = {
            #让这两个家伙下线
            set_country_flag = roz_unholy_invasion_defend_proj_aggressive
            set_country_flag = ge_sgt_busy
            set_country_flag = ge_nfield_diplomacy_activated
            event_target:roz_leader_kirakishou_global_target@root = {
                exile_leader_as = this
            }
            event_target:roz_leader_suigintou_global_target@root = {
                exile_leader_as = this
            }
            ruler = {
                save_global_event_target_as = roz_ruler_target_temp@root
            }
        }
        enable_special_project = {
            name = roz_unholy_invasion_defproj_1
        }
    }
}

country_event = {
    #没翻车
    id = roz_shinku_evt.432
    is_triggered_only = yes
    title = "roz_shinku_evt.432.title"
    desc = "roz_shinku_evt.432.desc"
    picture = GFX_evt_tradestation_interior
    show_sound = event_celebration
    location = event_target:roz_n_field_site_target@root
    trigger = {
        is_ai = no
    }
    immediate = {
        remove_country_flag = unholy_invasion_defend_proj_aggressive
        remove_country_flag = ge_sgt_busy
        remove_country_flag = ge_nfield_diplomacy_activated
        owner = {
            set_leader = event_target:roz_leader_kirakishou_global_target@root
            set_leader = event_target:roz_leader_suigintou_global_target@root
            set_leader = event_target:roz_ruler_target_temp@root
        }
        clear_global_event_target = roz_ruler_target_temp@root
    }
    option = {
        name =  roz_shinku_evt.432.aa
        add_monthly_resource_mult = {
            value = 3
            resource = unity
        }
        add_monthly_resource_mult = {
            value = 1
            resource = influence
        }
    }
    option = {
        name =  roz_shinku_evt.432.bb
        add_resource = {
            physics_research = 10000
            engineering_research = 10000
            society_research = 10000
        }
    }
    after = {
        enable_special_project = {
            name = roz_stare_into_the_abyss
            location = event_target:roz_n_field_site_target@root
        }
    }
}

country_event = {
    #翻车了，接卷土重来二方案的战斗
    id = roz_shinku_evt.433
    is_triggered_only = yes
    title = "roz_shinku_evt.433.title"
    desc = "roz_shinku_evt.433.desc"
    show_sound = event_red_alert
    picture = GFX_evt_machine_space_battle
    location = event_target:roz_n_field_site_target@root
    trigger = {
        is_ai = no
    }
    immediate = {
        remove_country_flag = unholy_invasion_defend_proj_aggressive
        remove_country_flag = ge_sgt_busy
        remove_country_flag = ge_nfield_diplomacy_activated
        owner = {
            set_leader = event_target:roz_leader_kirakishou_global_target@root
            set_leader = event_target:roz_leader_suigintou_global_target@root
            set_leader = event_target:roz_ruler_target_temp@root
        }
        clear_global_event_target = roz_ruler_target_temp@root
    }
    option = {
        name =  roz_shinku_evt.433.aa
    }
    option = {
        name =  roz_shinku_evt.433.bb
    }
    after = {
        hidden_effect = { 
            roz_madgod_country_initiate = yes
            roz_madgod_fleet_jtcl_create_direct = yes 
        }
    }
}

###卷土重来：二方案
country_event = {
    id = roz_shinku_evt.434
    is_triggered_only = yes
    title = roz_shinku_evt.434.title
    desc = roz_shinku_evt.434.desc
    picture = GFX_evt_board_meeting
    show_sound = event_ship_bridge
    location = event_target:roz_n_field_site_target@root
    trigger = {
        has_country_flag = roz_unholy_invasion_defend_proj_conservative
    }
    immediate = {

    }
    option = {
        name =  roz_shinku_evt.434.aa
        add_resource = {
            energy = -50000
            sr_rosa_mystica = -5000
        }
        event_target:roz_n_field_site_target@root = {
            enable_special_project = {#在n之领域坟头刷
                name = roz_unholy_invasion_defproj_1_decoy__1
                owner = root
                location = this
            }
        }
    }
}

country_event = {
    id = roz_shinku_evt.435
    is_triggered_only = yes
    title = roz_shinku_evt.435.title
    desc = roz_shinku_evt.435.desc
    picture = GFX_evt_astral_rift_nomask
    show_sound = event_construction
    location = event_target:roz_n_field_site_target@root
    trigger = {
        #has_country_flag = roz_unholy_invasion_defend_proj_conservative
        always = yes
    }
    option = {
        name =  roz_shinku_evt.435.aa
        custom_tooltip = roz_shinku_evt.435.aa.ct
        hidden_effect = {
            country_event = {
                id = roz_shinku_evt.436
                days = 30
                random = 60
            }
            create_ambient_object = {
                type = solar_storm
                scale = 0.1
                location = event_target:roz_n_field_site_target@root
                effect = { save_global_event_target_as = roz_unholy_invasion_bait@root }
            }
        }
    }
}

country_event = {
    id = roz_shinku_evt.436
    is_triggered_only = yes
    title = roz_shinku_evt.436.title
    desc = roz_shinku_evt.436.desc
    picture = GFX_evt_fleet_evil
    show_sound = event_red_alert
    location = event_target:roz_n_field_site_target@root
    trigger = {
        has_country_flag = roz_unholy_invasion_defend_proj_conservative
    }
    immediate = {

    }
    option = {
        name =  roz_shinku_evt.436.aa
        add_modifier = {
            modifier = roz_unholy_invasion_defproj_1_defender_buff
            months = 6
        }
        hidden_effect = {
            set_country_flag = roz_unholy_invasion_defend_flag
            roz_madgod_country_initiate = yes
            roz_madgod_fleet_jtcl_create_decoy = yes
        }
    }
}

###卷土重来：战斗残骸
###分支汇总(翻车的一方案与二方案)
country_event = {
    #触发事件跳转
    id = roz_shinku_evt.439
    hide_window = yes
    is_triggered_only = yes
    trigger = {
        This = {
            has_country_flag = roz_madgod_force_country_flag
        }
        From = {    #player country
            has_country_flag = roz_unholy_invasion_defend_flag
            has_country_flag = roz_leader_suigintou_get
            is_ai = no
        }
        FromFrom = {    #enemy fleet
            has_fleet_flag = roz_madgod_jtcl_fleet
        }
    }
    immediate = {
        From = {
            country_event = {
                id = roz_shinku_evt.440
            }
        }
    }
}
country_event = {
    id = roz_shinku_evt.440
    is_triggered_only = yes
    title = roz_shinku_evt.440.title
    desc = roz_shinku_evt.440.desc
    show_sound = event_bad_omen
    location = event_target:roz_n_field_site_target@root
    picture = GFX_evt_astral_rift_ancient_battlegrounds
    trigger = {
        is_ai = no
    }
    immediate = {
        remove_country_flag = roz_unholy_invasion_defend_flag
        destroy_ambient_object = event_target:roz_unholy_invasion_bait@root
    }
    option = {
        name =  roz_shinku_evt.440.aa
        enable_special_project = {
            name = roz_stare_into_the_abyss
            location = event_target:roz_n_field_site_target@root
            owner = root
        }
    }
}

###################卷土重来故事链结束
##特殊项目：凝视深渊 完成事件
ship_event = {
    id = roz_shinku_evt.441
    is_triggered_only = yes
    title = roz_shinku_evt.441.title
    desc = roz_shinku_evt.441.desc
    show_sound = event_alien_abduction
    picture = GFX_evt_exploding_ship
    trigger = {
        owner = { is_ai = no }
    }
    option = {
        name =  roz_shinku_evt.441.aa
        custom_tooltip = roz_shinku_evt.441.ct
        reduce_hp_percent = 0.75
        owner = {
            add_modifier = {
                modifier = roz_stare_into_the_abyss_debuff
                months = 3
            }
            hidden_effect = {
                country_event = {
                    id = roz_shinku_evt.445
                    days = 10
                }
            }
        }
    }
}

country_event = {
    id = roz_shinku_evt.445
    diplomatic = yes
    title = roz_shinku_evt.442.title
    desc = roz_shinku_evt.442.desc_1
    is_triggered_only = yes
    picture_event_data = {
        room = no_video_feed_room
    }
    trigger = {
        is_ai = no
    }
    option = {
        name =  roz_shinku_evt.442.0
        trigger = { NOT = { has_country_flag = roz_shinku_evt_442 } }
        hidden_effect = { set_country_flag = roz_shinku_evt_442 }
        country_event = { id = roz_shinku_evt.442 }
    }
}

country_event = {
    id = roz_shinku_evt.442
    diplomatic = yes
    title = roz_shinku_evt.442.title
    desc = roz_shinku_evt.442.desc_2
    show_sound = event_swarm_started
    is_triggered_only = yes
    picture_event_data = {
        room = no_video_feed_room
    }
    trigger = {
        is_ai = no
    }  
    option = {
        name =  roz_shinku_evt.442.aa
        trigger = { has_country_flag = roz_shinku_evt_442 }
        response_text = roz_shinku_evt.442.aa.ct
        is_dialog_only = yes
    }
    option = {
        name =  roz_shinku_evt.442.bb
        trigger = { has_country_flag = roz_shinku_evt_442 }
        response_text = roz_shinku_evt.442.bb.ct
        is_dialog_only = yes
    }
    option = {
        name =  roz_shinku_evt.442.cc
        trigger = { has_country_flag = roz_shinku_evt_442 }
        response_text = roz_shinku_evt.442.cc.ct
        is_dialog_only = yes
    }
    option = {
        name =  roz_shinku_evt.442.dd
        trigger = { has_country_flag = roz_shinku_evt_442 }
        default_hide_option = yes
        hidden_effect = { remove_country_flag = roz_shinku_evt_442 }
    }
}
country_event = {
    id = roz_shinku_evt.443
    title = roz_shinku_evt.443.title
    desc = roz_shinku_evt.443.desc
    show_sound = event_ex_started
    diplomatic = yes
    picture_event_data = {
        room = no_video_feed_room
    }
    is_triggered_only = yes
    trigger = {
        is_ai = no
    }
    immediate = {
    }
    option = {
        name =  roz_shinku_evt.443.aa
        custom_tooltip = roz_shinku_evt.443.aa.ct
        country_event = {
            id = roz_shinku_evt.450
            random = 8
        }
    }
}

####
####————真红事件链，雏莓部分————####
country_event = {
    id = roz_shinku_evt.450
    title = roz_shinku_evt.450.title
    desc = roz_shinku_evt.450.desc
    diplomatic = yes
    picture_event_data = { room = roz_junn_room }
    show_sound = event_finding_loot
    is_triggered_only = yes
    trigger = {
        is_ai = no
    }
    immediate = {
        #樱田纯的联系恢复
        remove_country_flag = roz_junn_dip_locked
        set_country_flag = roz_shinku_jtcl_end_flag
    }
    option = {
        name =  roz_shinku_evt.450.aa
        custom_tooltip = roz_shinku_evt.450.ct
    }
    option = {
        name =  roz_shinku_evt.450.bb
        custom_tooltip = roz_shinku_evt.450.ct
    }
    after = {
        hidden_effect = {
            country_event = {
                id  =   roz_shinku_evt.451
                days = 3
                random = 3
            }
        }
    }
}

country_event = {
    id = roz_shinku_evt.451
    title = roz_shinku_evt.451.title
    desc = roz_shinku_evt.451.desc
    picture = GFX_evt_roz_hinaichiko_visit
    show_sound = event_cityscape
    is_triggered_only = yes
    trigger = {
        is_ai = no
    }
    immediate = {

    }
    option = {
        name =  roz_shinku_evt.451.aa
    }
    option = {
        name =  roz_shinku_evt.451.bb
    }
}

country_event = {
    id = roz_shinku_evt.452
    title = roz_shinku_evt.452.title
    desc = roz_shinku_evt.452.desc
    is_triggered_only = yes
    show_sound = event_factions
    diplomatic = yes
    picture_event_data = {
        room = roz_rozen_party_room
    }
    trigger = {
        is_ai = no
        NOT = {
            exists = event_target:roz_hinaichigo_global_country@root
        }
    }
    immediate = {

    }
    option = {
        name =  roz_shinku_evt.452.aa
        response_text = roz_shinku_evt.452.aa_res
        is_dialog_only = yes
    }
    option = {
        name =  roz_shinku_evt.452.bb
        response_text = roz_shinku_evt.452.bb_res
        is_dialog_only = yes
    }
    option = {
        name =  roz_shinku_evt.452.cc
        response_text = roz_shinku_evt.452.cc_res
        is_dialog_only = yes
    }
    option = {
        name =  roz_shinku_evt.452.dd
        response_text = roz_shinku_evt.452.dd_res
        is_dialog_only = yes
    }
    option = {
        name =  roz_shinku_evt.452.ee
        response_text = roz_shinku_evt.452.ee_res
        custom_tooltip = roz_shinku_evt.452.ee_ct
        hidden_effect = {
            roz_hinaichigo_country_create = yes
        }
    }
}

country_event = {
    id = roz_shinku_evt.453
    title = roz_shinku_evt.453.title
    desc = roz_shinku_evt.453.desc
    is_triggered_only = yes
    diplomatic = yes
    show_sound = event_scanner
    picture_event_data = {
        room = roz_junn_room
    }
    trigger = {
        is_ai = no
    }
    option = {
        name = roz_shinku_evt.453.aa
        response_text = roz_shinku_evt.453.aa_res
        is_dialog_only = yes
    }
    option = {
        name = roz_shinku_evt.453.bb
        response_text = roz_shinku_evt.453.bb_res
        is_dialog_only = yes
    }
    option = {
        name = roz_shinku_evt.453.cc
        response_text = roz_shinku_evt.453.cc_res
        is_dialog_only = yes
    }
    option = {
        name = roz_shinku_evt.453.dd
        response_text = roz_shinku_evt.453.dd_res
        custom_tooltip = roz_shinku_evt.453.dd_ct
        hidden_effect = {
            set_country_flag = roz_SK_2_jtcl_complete
        }
    }
    after = {
        hidden_effect = {
            country_event = {
                id = roz_shinku_evt.500
                days = 30
            }
        }
    }
}


###第三阶段-见识超凡
###——————真红事件链，希灵援助部分——————

#陷入僵局
country_event = {
    id = roz_shinku_evt.500
    hide_window = yes
    is_triggered_only = yes
    immediate = {
        if = {  #没有完成卷土重来事件链和解析蔷薇圣母局势前会不断循环触发
            limit = {
                NOR = {
                    has_country_flag = roz_SK_1_kxbj_complete
                    has_country_flag = roz_SK_2_jtcl_complete
                }
            }
            country_event = {
                id = roz_shinku_evt.500
                days = 30
                random = 30
            }
        }
        else = {
            country_event = {
                id = roz_shinku_evt.501
            }
            break = yes
        }
    }
}

country_event = {
    id = roz_shinku_evt.501
    title = roz_shinku_evt.501.title
    desc = roz_shinku_evt.501.desc
    is_triggered_only = yes
    diplomatic = yes
    show_sound = event_comms_cutoff
    picture_event_data = {
        room = paragon_skrand_room
    }
    trigger = {
        is_ai = no
        has_country_flag = roz_SK_1_kxbj_complete
        has_country_flag = roz_SK_2_jtcl_complete
    }
    option = {
        name = roz_shinku_evt.501.aa
        response_text = roz_shinku_evt.501.aa_res
        is_dialog_only = yes
    }
    option = {
        name = roz_shinku_evt.501.bb
        response_text = roz_shinku_evt.501.bb_res
        is_dialog_only = yes
    }
    option = {
        name = roz_shinku_evt.501.cc
        response_text = roz_shinku_evt.501.cc_res
        default_hide_option = yes
    }
    after = {
        custom_tooltip = roz_shinku_evt.501.ct
        hidden_effect = {
            set_country_flag = roz_SK_3_start_reward
            country_event = {
                id = roz_shinku_evt.502
                days = 7
                random = 21
            }
        }
    }
}

#意外之友
country_event = {
    id = roz_shinku_evt.502
    title = roz_shinku_evt.502.title
    desc = roz_shinku_evt.502.desc
    is_triggered_only = yes
    picture = GFX_evt_roz_xiling_meeting
    show_sound = event_radio_chatter
    trigger = {
        is_ai = no
        has_country_flag = roz_SK_1_kxbj_complete
        has_country_flag = roz_SK_2_jtcl_complete
    }
    option = {
        name = roz_shinku_evt.502.aa
        add_event_chain_counter = { event_chain = roz_wake-up_shinku_chain counter = roz_wake-up_shinku_chain_progress amount = 1 }
        country_event = {
            id = roz_shinku_evt.503
            days = 3
            random = 4
        }
    }
}

country_event = {
    id = roz_shinku_evt.503
    title = roz_shinku_evt.503.title
    desc = roz_shinku_evt.503.desc
    is_triggered_only = yes
    picture = GFX_evt_astral_rift_crystal_1
    show_sound = event_crystal_ship
    trigger = {
        is_ai = no
        has_country_flag = roz_SK_1_kxbj_complete
        has_country_flag = roz_SK_2_jtcl_complete
    }
    option = {
        name = roz_shinku_evt.503.aa
        country_event = {
            id = roz_shinku_evt.504
            days = 1
        }
        add_relic = r_roz_extrinsic_xinlin_crystal_unknow
    }
}

country_event = {
    id = roz_shinku_evt.504
    title = roz_shinku_evt.504.title
    desc = roz_shinku_evt.504.desc
    is_triggered_only = yes
    show_sound = event_lootbox_good
    picture = GFX_evt_astral_rift_psionic_stranger_2
    trigger = {
        is_ai = no
        has_country_flag = roz_SK_1_kxbj_complete
        has_country_flag = roz_SK_2_jtcl_complete
    }
    option = {
        name = roz_shinku_evt.504.aa
        enable_special_project = {
            name = roz_poring_xiling_crystal
            owner = root
        }
    }
}

country_event = {
    id = roz_shinku_evt.510
    title = roz_shinku_evt.510.title
    desc = roz_shinku_evt.510.desc
    is_triggered_only = yes
    picture = GFX_evt_engineering_research
    show_sound = event_activating_unknown_technology
    trigger = {
        is_ai = no
        has_country_flag = roz_SK_1_kxbj_complete
        has_country_flag = roz_SK_2_jtcl_complete
    }
    option = {
        name = roz_shinku_evt.510.aa
        add_relic = r_roz_extrinsic_xinlin_crystal
        hidden_effect = {
            remove_relic = r_roz_extrinsic_xinlin_crystal_unknow
            give_technology = {
                tech = tech_roz_information_remodeler
            }
        }
    }
}

#资讯重构仪基址建设完成
country_event = {
    id = roz_shinku_evt.512
    title = roz_shinku_evt.512.title
    desc = roz_shinku_evt.512.desc
    is_triggered_only = yes
    picture = GFX_evt_megastructure_construction
    show_sound = event_mega_structure_other_empire_build_complete
    trigger = {
        is_ai = no
    }
    option = {
        name = roz_shinku_evt.512.aa
    }
    option = {
        name = roz_shinku_evt.512.bb
    }
    after = {
        add_resource = {
            influence = 200
        }
        add_monthly_resource_mult = {
            resource = unity
            value = 12
        }
    }
}

#资讯重构仪巨构完工
country_event = {
    id = roz_shinku_evt.513
    title = roz_shinku_evt.513.title
    desc = roz_shinku_evt.513.desc
    is_triggered_only = yes
    picture = GFX_evt_roz_megastructure_IR
    picture = GFX_evt_megastructure_construction
    trigger = {
        is_ai = no
    }
    option = {
        name = roz_shinku_evt.513.aa
        play_sound = event_big_door_opening
        country_event = {
            id = roz_shinku_evt.514
            days = 1
        }
    }
    after = {
        add_resource = {
            influence = 250
        }
        add_monthly_resource_mult = {
            resource = unity
            value = 18
        }
    }
}

country_event = {
    id = roz_shinku_evt.514
    title = roz_shinku_evt.514.title
    desc = roz_shinku_evt.514.desc
    is_triggered_only = yes
    picture = GFX_evt_roz_xiling_meeting_2
    show_sound = event_energy_field
    trigger = {
        is_ai = no
    }
    immediate = {
        set_country_flag = roz_mega_information_remodeler_active
    }
    option = {
        name = roz_shinku_evt.514.aa
        custom_tooltip = roz_shinku_evt.514.aa.ct
        add_modifier = {
            modifier = roz_mega_information_remodeler_active_bonus
        }
    }
    after = {
        country_event = {
            id = roz_shinku_evt.515
        }
    }
}

country_event = {
    id = roz_shinku_evt.515
    title = roz_shinku_evt.515.title
    desc = roz_shinku_evt.515.desc
    is_triggered_only = yes
    diplomatic = yes
    show_sound = event_cityscape
    picture_event_data = {
        room = roz_xiling_meeting_event_room
    }
    trigger = {
        is_ai = no
    }
    option = {
        name = roz_shinku_evt.515.aa
        response_text = roz_shinku_evt.515.aa.res
        is_dialog_only = yes
    }
    option = {
        name = roz_shinku_evt.515.bb
        response_text = roz_shinku_evt.515.bb.res
        is_dialog_only = yes
    }
    option = {
        name = roz_shinku_evt.515.cc
        response_text = roz_shinku_evt.515.cc.res
        is_dialog_only = yes
    }
    option = {
        name = roz_shinku_evt.515.dd
        response_text = roz_shinku_evt.515.dd.res
        default_hide_option = yes
    }
    after = {
        add_modifier = {
            modifier = roz_SK_xiling_enhanced_buff
            days = 720
        }
        country_event = {
            id = roz_shinku_evt.516
            days = 1
        }
    }
}

#拨云见日
country_event = {
    id = roz_shinku_evt.516
    title = roz_shinku_evt.516.title
    desc = roz_shinku_evt.516.desc
    is_triggered_only = yes
    picture = GFX_evt_cosmogenesis_crisis
    trigger = {
        is_ai = no
    }
    option = {
        name = roz_shinku_evt.516.aa
        custom_tooltip = roz_shinku_evt.516.ct
    }
    option = {
        name = roz_shinku_evt.516.bb
        custom_tooltip = roz_shinku_evt.516.ct
    }
    after = {
        country_event = {
            id = roz_shinku_evt.517
            days = 5
        }
    }
}

country_event = {
    id = roz_shinku_evt.517
    title = roz_shinku_evt.517.title
    desc = roz_shinku_evt.517.desc
    is_triggered_only = yes
    picture = GFX_evt_roz_rozen_party
    show_sound = event_assembly_fight
    trigger = {
        is_ai = no
    }
    location = event_target:roz_outland_planet@root.solar_system.star
    immediate = {
        event_target:roz_outland_planet@root = {
            solar_system = {
                star = { save_global_event_target_as = roz_outland_main_black_hole@root }
            }
        }
    }
    option = {
        name = roz_shinku_evt.517.aa
        custom_tooltip = roz_shinku_evt.517.ct
        enable_special_project = {
            name = roz_unholy_invasion_defproj_decoy_II
            location = event_target:roz_outland_main_black_hole@root
            owner = root
        }
        start_situation = {
            type = roz_SK_4_madgod_invasion_alert
        }
    }
}

####
##——————真红事件链，BOSS战和之后部分——————
country_event = {   #部署墨水人诱饵装置
    id = roz_shinku_evt.520
    title = roz_shinku_evt.520.title
    desc = roz_shinku_evt.520.desc
    is_triggered_only = yes
    show_sound = event_engineered_evolution
    picture = GFX_evt_ship_in_orbit_3
    trigger = {
        is_ai = no
        NOT = {
            has_country_flag = roz_SK_4_decoyII_start
        }
    }
    location = event_target:roz_outland_main_black_hole@root
    immediate = {
        set_country_flag = roz_SK_4_decoyII_start
    }
    option = {
        name = roz_shinku_evt.520.aa
        add_event_chain_counter = { event_chain = roz_wake-up_shinku_chain counter = roz_wake-up_shinku_chain_progress amount = 1 }
    }
}

country_event = {   #装置部署完成
    id = roz_shinku_evt.521
    title = roz_shinku_evt.521.title
    desc = roz_shinku_evt.521.desc
    is_triggered_only = yes
    picture = GFX_evt_cosmic_storms_gravity_storm
    trigger = {
        is_ai = no
    }
    show_sound = event_activating_unknown_technology
    location = event_target:roz_outland_main_black_hole@root
    option = {
        name = roz_shinku_evt.521.aa
        event_target:roz_outland_main_black_hole@root = {
            create_ambient_object = {
                type = roz_SK4_decoyII_beacon
                location = this
            }
        }
        hidden_effect = {
            country_event = {
                id = roz_shinku_evt.522
                days = 31
            }
        }
    }
}

country_event = {   #抵达
    id = roz_shinku_evt.522
    title = roz_shinku_evt.522.title
    desc = roz_shinku_evt.522.desc
    is_triggered_only = yes
    picture = GFX_evt_fleet_evil
    show_sound = event_red_alert
    trigger = {
        is_ai = no
    }
    location = event_target:roz_outland_main_black_hole@root
    option = {
        name = roz_shinku_evt.522.aa
        country_event = {
            id = roz_shinku_evt.523
        }
        event_target:roz_madgod_force_country@root = {
            establish_communications_no_message = root
        }
    }
}

country_event = {   #混乱通讯 #深渊入侵正式开始
    id = roz_shinku_evt.523
    title = roz_shinku_evt.523.title
    desc = roz_shinku_evt.523.desc
    is_triggered_only = yes
    diplomatic = yes
    picture_event_data = {
        portrait = roz_exd_red
        room = roz_madgod_room
    }
    show_sound = ap_rift_event_14_centipede_monster_angry
    trigger = {
        is_ai = no
    }
    immediate = { set_country_flag = roz_abyss_faction_arrival }
    option = {
        name = roz_shinku_evt.523.aa
        custom_tooltip = roz_shinku_evt.523.aa.ct
        is_dialog_only = yes
        response_text = roz_shinku_evt.523.aa.rec
    }
    option = {
        name = roz_shinku_evt.523.bb
        response_text = roz_shinku_evt.523.bb.res
        begin_event_chain = { event_chain = roz_SK_madgod_invasion_main target = root }
    }
    after = {
        #随机挑选幸运AI给深渊当狗
        roz_abyss_vass_select_diff = yes
        #额外AI给深渊当狗
        roz_abyss_vass_extra_awaken_in_diff = yes
        #
        every_country = {
            limit = { has_country_flag = roz_abyss_vass_country }
            country_event = { id = roz_shinku_evt.532 }
        }
    }
}

country_event = {
    id = roz_shinku_evt.524
    hide_window = yes
    is_triggered_only = yes
    trigger = {
        is_ai = no
    }
    immediate = {   #比较ai态度并计数
        roz_unholy_invasion_dip_effect = {  #支持者
            sign = ">="
            opinion = aggressive
        }
        roz_unholy_invasion_dip_effect = {  #反对者
            sign = "<="
            opinion = negative
        }
        roz_unholy_invasion_dip_effect = {  #中立者
            sign = "="
            opinion = neutral
        }
        
        #开始对比
        if = {  #各持己见，中立
            limit = {
                NAND = {    #此条件不能全中立
                    check_variable = { which = roz_unholy_invasion_dip_negative_ai value = 0 }
                    check_variable = { which = roz_unholy_invasion_dip_aggressive_ai value = 0 }
                }
                OR = {
                    check_variable_arithmetic = {   #中立国家较多
                        which = roz_unholy_invasion_dip_neutral_ai
                        subtract = roz_unholy_invasion_dip_negative_ai
                        subtract = roz_unholy_invasion_dip_aggressive_ai
                        value > 0
                    }
                    check_variable_arithmetic = {   #支持者与反对者战平
                        which = roz_unholy_invasion_dip_aggressive_ai
                        subtract = roz_unholy_invasion_dip_negative_ai
                        value = 0
                    }
                }
            }
            set_country_flag = roz_unholy_invasion_dip_compare_neutral_flag
        }
        else_if = { #总体结果为反对
            limit = {
                check_variable_arithmetic = {
                    which = roz_unholy_invasion_dip_negative_ai
                    subtract = roz_unholy_invasion_dip_aggressive_ai
                    value > 0
                }
            }
            set_country_flag = roz_unholy_invasion_dip_compare_negative_flag
        }
        else_if = { #总体结果为支持
            limit = {
                check_variable_arithmetic = {
                    which = roz_unholy_invasion_dip_aggressive_ai
                    subtract = roz_unholy_invasion_dip_negative_ai
                    value > 0
                }
            }
            set_country_flag = roz_unholy_invasion_dip_compare_aggressive_flag
        }
        else_if = {  #缺省
            limit = {
                OR = {
                    AND = { #只有中立
                        is_variable_set = roz_unholy_invasion_dip_neutral_ai
                        check_variable = {
                            which = roz_unholy_invasion_dip_negative_ai
                            value = 0
                        }
                        check_variable = {
                            which = roz_unholy_invasion_dip_aggressive_ai
                            value = 0
                        }
                    }
                    NAND = {    #没一个是人
                        is_variable_set = roz_unholy_invasion_dip_neutral_ai
                        is_variable_set = roz_unholy_invasion_dip_negative_ai
                        is_variable_set = roz_unholy_invasion_dip_aggressive_ai
                    }
                }
            }
            set_country_flag = roz_unholy_invasion_dip_compare_none_flag
        }
    }
}

country_event = {
    id = roz_shinku_evt.525
    title = roz_shinku_evt.525.title
    desc = {
        trigger = {
            has_country_flag = roz_unholy_invasion_dip_compare_aggressive_flag
        }
        text = roz_shinku_evt.525.desc.aggressive
    }
    desc = {
        trigger = {
            has_country_flag = roz_unholy_invasion_dip_compare_negative_flag
        }
        text = roz_shinku_evt.525.desc.negative
    }
    desc = {
        trigger = {
            has_country_flag = roz_unholy_invasion_dip_compare_neutral_flag
        }
        text = roz_shinku_evt.525.desc.neutral
    }
    is_triggered_only = yes
    picture = GFX_evt_galactic_community
    show_sound = event_galactic_community
    trackable = yes
    trigger = {
        is_ai = no
    }
    immediate = {
        random_playable_country = {
            limit = {
                has_country_flag = roz_unholy_invasion_dip_aggressive_ai_flag
            }
            save_event_target_as = roz_unholy_invasion_dip_aggressive_ai_target
        }
        random_playable_country = {
            limit = {
                has_country_flag = roz_unholy_invasion_dip_negative_ai_flag
            }
            save_event_target_as = roz_unholy_invasion_dip_negative_ai_target
        }
        every_country = {
            limit = {
                OR = {
                    is_country_type = default
                    is_country_type = fallen_empire
                    is_country_type = awakened_fallen_empire
                    is_ai = yes
                }
            }
            establish_communications_no_message = event_target:roz_madgod_force_country@root
        }
    }
    after = {
        begin_event_chain = {
            event_chain = roz_SK_madgod_invasion_main
        }
        ###清除临时数据
        clear_variable = roz_unholy_invasion_dip_neutral_ai
        clear_variable = roz_unholy_invasion_dip_negative_ai
        clear_variable = roz_unholy_invasion_dip_aggressive_ai
        every_playable_country = {
            limit = { NOT = { has_country_flag = roz_abyss_vass_country } }
            remove_country_flag = roz_unholy_invasion_dip_aggressive_ai_flag
            remove_country_flag = roz_unholy_invasion_dip_negative_ai_flag
            remove_country_flag = roz_unholy_invasion_dip_neutral_ai_flag
        }
        #启动循环事件更新数据
        country_event = {
            id = roz_shinku_evt.526
            days = 30
        }
        set_country_flag = roz_unholy_invasion_dip_refresh_active_flag
    }
}

country_event = {
    id = roz_shinku_evt.526
    hide_window = yes
    is_triggered_only = yes
    trigger = {
        is_ai = no
        has_country_flag = roz_unholy_invasion_dip_refresh_active_flag
    }
    immediate = {
        ###清除临时数据
        clear_variable = roz_unholy_invasion_dip_neutral_ai
        clear_variable = roz_unholy_invasion_dip_negative_ai
        clear_variable = roz_unholy_invasion_dip_aggressive_ai
        every_playable_country = {
            limit = { NOT = { has_country_flag = roz_abyss_vass_country } }
            remove_country_flag = roz_unholy_invasion_dip_aggressive_ai_flag
            remove_country_flag = roz_unholy_invasion_dip_negative_ai_flag
            remove_country_flag = roz_unholy_invasion_dip_neutral_ai_flag
        }
        ###
        roz_unholy_invasion_dip_effect = {  #支持者
            sign = ">="
            opinion = aggressive
        }
        roz_unholy_invasion_dip_effect = {  #反对者
            sign = "<="
            opinion = negative
        }
        roz_unholy_invasion_dip_effect = {  #中立者
            sign = "="
            opinion = neutral
        }
        ###
        country_event = {
            id = roz_shinku_evt.526
            days = 30
        }
    }
}

###深渊阵营被击杀计数
country_event = {
    id = roz_shinku_evt.530
    hide_window = yes
    is_triggered_only = yes
    trigger = {
        is_country_type = roz_madgod_empire
    }
    immediate = {
        if = {
            limit = {
                FROM = { has_event_chain = roz_SK_madgod_invasion_main }
            }
            FROM = {
                add_event_chain_counter = {
                    event_chain = "roz_SK_madgod_invasion_main"
                    counter = "roz_abyss_kills_us"
                    amount = 1
                }
            }
        }
        every_playable_country = {
            limit = {
                has_event_chain = "roz_SK_madgod_invasion_main"
                NOT = { is_same_value = FROM }
            }
            add_event_chain_counter = {
                event_chain = "roz_SK_madgod_invasion_main"
                counter = "roz_abyss_kills_others"
                amount = 1
            }
        }
    }
}

###深渊阵营击杀计数
# Abyss Victims
country_event = {
    id = roz_shinku_evt.531
    hide_window = yes
    is_triggered_only = yes
    trigger = {
        is_country_type = roz_madgod_empire
    }

    immediate = {
        every_playable_country = {
            limit = { has_event_chain = "roz_SK_madgod_invasion_main" }
            add_event_chain_counter = {
                event_chain = "roz_SK_madgod_invasion_main"
                counter = "roz_abyss_victims"
                amount = 1
            }
        }
    }
}

###深渊仆从国buff
country_event = {
    id = roz_shinku_evt.532
    hide_window = yes
    is_triggered_only = yes
    trigger = {
        has_country_flag = roz_abyss_vass_country
        fromfrom = { NOT = { has_modifier = roz_abyss_vass_combat_negative_modifier } }
    }
    immediate = {
        fromfrom = {
            add_modifier = { modifier = roz_abyss_vass_combat_negative_modifier }
        }
    }
}

####刷怪
country_event = {
    id = roz_shinku_evt.535
    hide_window = yes
    is_triggered_only = yes
    trigger = {
        has_country_flag = roz_abyss_faction_arrival
        any_playable_country = {
            has_country_flag = roz_abyss_vass_country
        }
    }
    immediate = {
        #为深渊仆从国刷防御舰队，该舰队所有者为其本身
        every_country = {
            limit = { has_country_flag = roz_abyss_vass_country }
            while = {
                count = 2
                roz_abyss_fleet_create_small_defense_in_diff = {
                    owner = prevprev
                    location = prevprev.capital_scope
                }
            }
            roz_abyss_fleet_create_median_defense_in_diff = {
                owner = prevprev
                location = prevprev.capital_scope
            }
            every_owned_planet = {
                limit = {
                    is_capital = no
                    solar_system = { any_system_planet = { is_colony = yes } }
                }
                roz_abyss_fleet_create_small_defense_in_diff = {
                    owner = prevprevprev
                    location = prevprev
                }
            }
        }
        #随机星系刷据点和守卫舰队
        roz_abyss_fleet_outpost_create_in_diff = yes
        #刷boss
        event_target:roz_madgod_force_country@root = {
            #防御舰队
            while = { count = 2
                roz_abyss_fleet_create_large_defense_in_diff = { owner = prevprev location = event_target:roz_n_field_site_target@root }
            }
            roz_abyss_fleet_create_marvelous_defense_in_diff = yes

            #进攻舰队
            roz_abyss_fleet_create_marvelous_attack_in_diff = { owner = prevprev location = event_target:roz_n_field_site_target@root }

            #boss
            roz_abyss_fleet_create_madgod_boss = yes
        }
    }
}

#墨水人乌拉诺斯初次复活
ship_event = {
    #madgod boss disable effect
    id = roz_shinku_evt.547
    hide_window = yes
    is_triggered_only = yes
    trigger = {
        is_ship_size = roz_crisis_madgod_boss
        from = { owner = { NOT = { has_country_flag = roz_crisis_madgod_boss_first_blood } } }
    }
    immediate = {
        #由击败者触发
        from = { owner = { country_event = { id = roz_shinku_evt.550 } } }
        #复活
        if = {  #检测深渊势力是否只剩下boss星系，如果返回yes，则只给予最后一次复活
            limit = { roz_is_all_abyss_killed_except_madgod_system = { scope = prevprevprev.from } }
            roz_ship_disable_protect_effect = yes
            set_disable_at_health = -1
            from = { owner = {
                country_event = { id = roz_shinku_evt.555 }
                set_country_flag = roz_crisis_madgod_boss_last_breath
            } }
        }
        else = {    #否则将无限复活
            ship_event = { id = roz_shinku_evt.549 days = 5 }
            from = { owner = { country_event = { id = roz_shinku_evt.555 days = 5 } } }
        }
    }
}

#墨水人乌拉诺斯复活机制
ship_event = {
    #madgod boss disable effect
    id = roz_shinku_evt.548
    hide_window = yes
    is_triggered_only = yes
    trigger = {
        is_ship_size = roz_crisis_madgod_boss
        from = { owner = { has_country_flag = roz_crisis_madgod_boss_first_blood } }
    }
    immediate = {
        #复活
        if = {  #检测深渊势力是否只剩下boss星系，如果返回yes，则只给予最后一次复活
            limit = { roz_is_all_abyss_killed_except_madgod_system = { scope = prevprevprev.from } }
            roz_ship_disable_protect_effect = yes
            set_disable_at_health = -1
            from = { owner = {
                country_event = { id = roz_shinku_evt.555 }
                set_country_flag = roz_crisis_madgod_boss_last_breath
            } }
        }
        else = {
            ship_event = { id = roz_shinku_evt.549 }
            from = { owner = { country_event = { id = roz_shinku_evt.555 } } }
        }
    }
}

ship_event = {
    id = roz_shinku_evt.549
    hide_window = yes
    is_triggered_only = yes
    trigger = { is_ship_size = roz_crisis_madgod_boss }
    immediate = { roz_ship_disable_protect_effect = yes }
}

#墨水人首次被击败
country_event = {
    id = roz_shinku_evt.550
    title = roz_shinku_evt.550.title
    desc = roz_shinku_evt.550.desc
    is_triggered_only = yes
    show_sound = event_space_battle
    picture = GFX_evt_large_explosion
    trigger = {
        is_ai = no
        NOT = { has_country_flag = roz_crisis_madgod_boss_first_blood }
    }
    abort_trigger = { has_active_event = { roz_shinku_evt.555 roz_shinku_evt.551 } }
    abort_effect = {
        add_resource = { influence = 100 }
        add_modifier = { modifier = roz_madgod_country_foible }
        hidden_effect = {
            if = {
                limit = { NOT = { has_active_event = { roz_shinku_evt.551 } } }
                country_event = { id = roz_shinku_evt.551 days = 2 }
            }
        }
    }
    immediate = {
        set_country_flag = roz_crisis_madgod_boss_first_blood
    }
    option = {
        name = roz_shinku_evt.550.aa
        add_resource = { influence = 100 }
        add_modifier = { modifier = roz_madgod_country_foible }
        hidden_effect = { country_event = { id = roz_shinku_evt.551 days = 2 } }
    }
}

#诡异通讯
country_event = {
    id = roz_shinku_evt.551
    title = roz_shinku_evt.551.desc
    is_triggered_only = yes
    diplomatic = yes
    show_sound = event_screams
    picture_event_data = { room = roz_madgod_room }
    trigger = {
        is_ai = no
    }
    immediate = {
        
    }
    option = {
        name = roz_shinku_evt.551.aa
    }
}

#击杀墨水人后复活时
country_event = {
    id = roz_shinku_evt.555
    title = roz_shinku_evt.555.title
    desc = {
        trigger = { NOT = { has_country_flag = roz_crisis_madgod_boss_last_breath } }
        text = roz_shinku_evt.555.desc1
    }
    desc = {
        trigger = { has_country_flag = roz_crisis_madgod_boss_last_breath }
        text = roz_shinku_evt.555.desc2
    }
    is_triggered_only = yes
    picture = GFX_evt_chronos_storm
    trigger = {
        NOT = { has_active_event = { roz_shinku_evt.555 } }
        OR = {
            NOT = { has_country_flag = roz_crisis_madgod_boss_revive_dont_remind }
            has_country_flag = roz_crisis_madgod_boss_last_breath
        }
    }
    immediate = {
        
    }
    option = {
        name = roz_shinku_evt.555.aa
        trigger = { NOT = { has_country_flag = roz_crisis_madgod_boss_last_breath } }
    }
    option = {
        name = roz_shinku_evt.SK_invasion_ignore
        custom_tooltip = roz_shinku_evt.SK_invasion_ignore.ct
        trigger = { NOT = { has_country_flag = roz_crisis_madgod_boss_last_breath } }
        hidden_effect = { set_country_flag = roz_crisis_madgod_boss_revive_dont_remind }
    }
    option = {
        name = roz_shinku_evt.555.bb
        trigger = { has_country_flag = roz_crisis_madgod_boss_last_breath }
        add_resource = { unity = 2500 }
        hidden_effect = {
            ###给穷途末路的boss上修正
        }
    }
}

#神国星系沦陷
country_event = {
    id = roz_shinku_evt.560
    title = roz_shinku_evt.560.title
    desc = roz_shinku_evt.560.desc
    is_triggered_only = yes
    picture = GFX_evt_roz_madgod_system
    trigger = {
        is_ai = no
        fromfrom = {
            exists = starbase
            solar_system = { is_same_value = event_target:roz_n_field_site_target@root }
        }
        NOT = { has_country_flag = roz_crisis_madgod_system_lost_dont_remind }
        NOT = { has_active_event = { roz_shinku_evt.560 } }
    }
    immediate = {
        
    }
    option = {
        name = roz_shinku_evt.560.aa
    }
    option = {
        name = roz_shinku_evt.SK_invasion_ignore
        custom_tooltip = roz_shinku_evt.SK_invasion_ignore.ct
        hidden_effect = { set_country_flag = roz_crisis_madgod_system_lost_dont_remind }
    }
}

#进入星系寻路轰炸
ship_event = {
    id = roz_shinku_evt.561
    hide_window = yes
    is_triggered_only = yes
    trigger = {
        fleet = { roz_is_abyss_attack_fleet = yes }
    }
    immediate = {
        fleet = { roz_abyss_fleet_invision_action_on_entering_system = yes }
    }
}

#月检舰队行为继续寻路星系
country_event = {
    id = roz_shinku_evt.562
    hide_window = yes
    is_triggered_only = yes
    trigger = {
        is_ai = no
    }
    immediate = {
        if = {
            limit = { exists = event_target:roz_madgod_force_country@root }
            event_target:roz_madgod_force_country@root = {
                every_owned_fleet = {
                    limit = {
                        roz_is_abyss_attack_fleet = yes
                        solar_system = { any_system_planet = { is_colony = no owner = { NOT = { has_country_flag = roz_abyss_vass_country } } } }
                    }
                    roz_abyss_fleet_invision_action_1 = yes
                }
            }
        }
    }
}

#深渊分遣舰队再次出现
country_event = {
    id = roz_shinku_evt.563
    title = roz_shinku_evt.563.title
    desc = roz_shinku_evt.563.desc
    is_triggered_only = yes
    picture = GFX_evt_roz_evt_subspace_1
    trigger = {
        is_ai = no
    }
    immediate = {
        
    }
    option = {
        name = roz_shinku_evt.563.aa
    }
    option = {
        name = roz_shinku_SK_invasion_ignore
        custom_tooltip = roz_shinku_evt.SK_invasion_ignore.ct
    }
}

#占领殖民地星系
country_event = {
    id = roz_shinku_evt.566
    title = roz_shinku_evt.566.title
    desc = roz_shinku_evt.566.desc
    is_triggered_only = yes
    picture = GFX_
    trigger = {
        is_ai = no
    }
    immediate = {
        
    }
    option = {
        name = roz_shinku_evt.566.aa
    }
    option = {
        name = roz_shinku_SK_invasion_ignore
        custom_tooltip = roz_shinku_evt.SK_invasion_ignore.ct
    }
}

###boss战局势阶段事件
country_event = {   #深渊感染体入侵
    id = roz_shinku_evt.610
    title = roz_shinku_evt.610.title
    desc = roz_shinku_evt.610.desc
    is_triggered_only = yes
    picture = GFX_
    trigger = {
        is_ai = no
    }
    location = event_target:roz_outland_planet@root
    immediate = {
        
    }
    option = {
        name = roz_shinku_evt.610.aa
        
    }
}

country_event = {   ##2转3
    id = roz_shinku_evt.611
    title = roz_shinku_evt.611.title
    desc = roz_shinku_evt.611.desc
    is_triggered_only = yes
    picture = GFX_
    trigger = {
        is_ai = no
    }
    location = event_target:roz_outland_planet@root
    immediate = {

    }
    option = {
        name = roz_shinku_evt.611.aa

    }
}

country_event = {   ##3转4
    id = roz_shinku_evt.612
    title = roz_shinku_evt.612.title
    desc = roz_shinku_evt.612.desc
    is_triggered_only = yes
    picture = GFX_
    trigger = {
        is_ai = no
    }
    location = event_target:roz_outland_planet@root
    immediate = {

    }
    option = {
        name = roz_shinku_evt.612.aa

    }
}

country_event = {   ##4转5
    id = roz_shinku_evt.613
    title = roz_shinku_evt.613.title
    desc = roz_shinku_evt.613.desc
    is_triggered_only = yes
    picture = GFX_
    trigger = {
        is_ai = no
    }
    location = event_target:roz_outland_planet@root
    immediate = {

    }
    option = {
        name = roz_shinku_evt.613.aa

    }
}

country_event = {   ##5转4
    id = roz_shinku_evt.614
    title = roz_shinku_evt.614.title
    desc = roz_shinku_evt.614.desc
    is_triggered_only = yes
    picture = GFX_
    trigger = {
        is_ai = no
    }
    location = event_target:roz_outland_planet@root
    immediate = {

    }
    option = {
        name = roz_shinku_evt.614.aa

    }
}

country_event = {   ##4转3
    id = roz_shinku_evt.615
    title = roz_shinku_evt.615.title
    desc = roz_shinku_evt.615.desc
    is_triggered_only = yes
    picture = GFX_
    trigger = {
        is_ai = no
    }
    location = event_target:roz_outland_planet@root
    immediate = {

    }
    option = {
        name = roz_shinku_evt.615.aa

    }
}

country_event = {   ##3转2
    id = roz_shinku_evt.616
    title = roz_shinku_evt.616.title
    desc = roz_shinku_evt.616.desc
    is_triggered_only = yes
    picture = GFX_
    trigger = {
        is_ai = no
    }
    location = event_target:roz_outland_planet@root
    immediate = {

    }
    option = {
        name = roz_shinku_evt.616.aa

    }
}

country_event = {   ##2转1
    id = roz_shinku_evt.617
    title = roz_shinku_evt.617.title
    desc = roz_shinku_evt.617.desc
    is_triggered_only = yes
    picture = GFX_
    trigger = {
        is_ai = no
    }
    location = event_target:roz_outland_planet@root
    immediate = {

    }
    option = {
        name = roz_shinku_evt.617.aa

    }
}

country_event = {   ##背水一战, 首次进入1
    id = roz_shinku_evt.618
    title = roz_shinku_evt.618.title
    desc = roz_shinku_evt.618.desc
    is_triggered_only = yes
    picture = GFX_
    trigger = {
        is_ai = no
    }
    location = event_target:roz_outland_planet@root
    immediate = {

    }
    option = {
        name = roz_shinku_evt.618.aa
    }
}

country_event = {   ##局势-好结局路线
    id = roz_shinku_evt.619
    title = roz_shinku_evt.619.title
    desc = roz_shinku_evt.619.desc
    is_triggered_only = yes
    picture = GFX_
    trigger = {
        is_ai = no
    }
    location = event_target:roz_outland_planet@root
    immediate = {

    }
    option = {
        name = roz_shinku_evt.619.aa
    }
    option = {
        name = roz_shinku_evt.619.bb
    }
}

country_event = {   ##局势-#坏路线
    id = roz_shinku_evt.630
    title = roz_shinku_evt.630.title
    desc = roz_shinku_evt.630.desc
    is_triggered_only = yes
    picture = GFX_
    trigger = {
        is_ai = no
    }
    location = event_target:roz_outland_planet@root
    immediate = {

    }
    option = {
        name = roz_shinku_evt.630.aa
    }
    option = {
        name = roz_shinku_evt.630.bb
    }
    option = {
        name = roz_shinku_evt.630.cc
    }
}

country_event = {   ##坏路线-至暗时刻
    id = roz_shinku_evt.631
    title = roz_shinku_evt.631.title
    desc = roz_shinku_evt.631.desc
    is_triggered_only = yes
    picture = GFX_
    trigger = {
        is_ai = no
    }
    immediate = {

    }
    option = {
        name = roz_shinku_evt.631.aa
        custom_tooltip = roz_shinku_evt.631.ct
    }
    option = {
        name = roz_shinku_evt.631.bb
        custom_tooltip = roz_shinku_evt.631.ct
    }
}

country_event = {   ##坏路线-蚍蜉撼树
    id = roz_shinku_evt.632
    title = roz_shinku_evt.632.title
    desc = roz_shinku_evt.632.desc
    is_triggered_only = yes
    picture = GFX_
    trigger = {
        is_ai = no
    }
    immediate = {

    }
    option = {
        name = roz_shinku_evt.632.aa
    }
}

country_event = {   ##坏路线-希望的曙光
    id = roz_shinku_evt.6321
    title = roz_shinku_evt.6321.title
    desc = roz_shinku_evt.6321.desc
    is_triggered_only = yes
    picture = GFX_
    trigger = {
        is_ai = no
    }
    immediate = {

    }
    option = {
        name = roz_shinku_evt.6321.aa
    }
}

country_event = {   ##坏路线-击碎绝望
    id = roz_shinku_evt.633
    title = roz_shinku_evt.633.title
    desc = roz_shinku_evt.633.desc
    is_triggered_only = yes
    picture = GFX_
    trigger = {
        is_ai = no
    }
    immediate = {

    }
    option = {
        name = roz_shinku_evt.633.aa
    }
    option = {
        name = roz_shinku_evt.633.bb
    }
}

country_event = {   ##路线收束：万事俱备
    id = roz_shinku_evt.650
    title = roz_shinku_evt.650.title
    desc = roz_shinku_evt.650.desc
    is_triggered_only = yes
    picture = GFX_
    trigger = {
        is_ai = no
    }
    immediate = {

    }
    option = {
        name = roz_shinku_evt.650.aa
        custom_tooltip = roz_shinku_evt.650.ct
    }
}

###
country_event = {   ##禁忌领域
    id = roz_shinku_evt.651
    title = roz_shinku_evt.651.title
    desc = roz_shinku_evt.651.desc
    is_triggered_only = yes
    picture = GFX_
    trigger = {
        is_ai = no
    }
    immediate = {

    }
    option = {
        name = roz_shinku_evt.651.aa
    }
}

country_event = {   ##长阶尽头
    id = roz_shinku_evt.652
    title = roz_shinku_evt.652.title
    desc = roz_shinku_evt.652.desc
    is_triggered_only = yes
    diplomatic = yes
    picture_event_data = {

    }
    trigger = {
        is_ai = no
    }
    immediate = {

    }
    option = {
        name = roz_shinku_evt.652.aa
        is_dialog_only = yes
        response_text = roz_shinku_evt.652.aa.res
    }
    option = {
        name = roz_shinku_evt.652.bb
        is_dialog_only = yes
        response_text = roz_shinku_evt.652.bb.res
    }
    option = {
        name = roz_shinku_evt.652.cc
        default_hide_option = yes
        response_text = roz_shinku_evt.652.cc.res
    }
}

country_event = {   ##复现奇迹
    id = roz_shinku_evt.654
    title = roz_shinku_evt.654.title
    desc = roz_shinku_evt.654.desc
    is_triggered_only = yes
    picture = GFX_
    trigger = {
        is_ai = no
    }
    immediate = {

    }
    option = {
        name = roz_shinku_evt.654.aa
    }
    option = {
        name = roz_shinku_evt.654.bb
    }
}

country_event = {   ##蔷薇圣母
    id = roz_shinku_evt.655
    title = roz_shinku_evt.655.title
    desc = roz_shinku_evt.655.desc
    is_triggered_only = yes
    picture = GFX_
    trigger = {
        is_ai = no
    }
    immediate = {

    }
    option = {
        name = roz_shinku_evt.655.aa
    }
    option = {
        name = roz_shinku_evt.655.bb
    }
    option = {
        name = roz_shinku_evt.655.cc
    }
}


#真红苏醒
country_event = {
    id = roz_shinku_evt.660
    title = roz_shinku_evt.660.title
    desc = roz_shinku_evt.660.desc
    is_triggered_only = yes
    picture = GFX_
    trigger = {
        is_ai = no
    }
    immediate = {

    }
    option = {
        name = roz_shinku_evt.660.aa
    }
    option = {
        name = roz_shinku_evt.660.bb
    }
}

country_event = {   #"HAPPY ENDDING?
    id = roz_shinku_evt.661
    title = roz_shinku_evt.661.title
    desc = roz_shinku_evt.661.desc
    is_triggered_only = yes
    picture = GFX_
    trigger = {
        is_ai = no
    }
    immediate = {

    }
    option = {
        name = roz_shinku_evt.661.aa
    }
    option = {
        name = roz_shinku_evt.661.bb
    }
}



####真红危机后日谈，四人茶会

country_event = {   #
    id = roz_shinku_evt.701
    title = roz_shinku_evt.701.title
    desc = roz_shinku_evt.701.desc
    is_triggered_only = yes
    diplomatic = yes
    picture_event_data = {
        room = no_video_feed_room
        #portrait = 
    }
    trigger = {
        is_ai = no
    }
    immediate = {

    }
    option = {
        name = roz_shinku_evt.701.aa
        is_dialog_only = yes
        response_text = roz_shinku_evt.701.aa.res
    }
    option = {
        name = roz_shinku_evt.701.bb
        is_dialog_only = yes
        response_text = roz_shinku_evt.701.bb.res
    }
    option = {
        name = roz_shinku_evt.701.cc
        is_dialog_only = yes
        response_text = roz_shinku_evt.701.cc.res
    }
    option = {
        name = roz_shinku_evt.701.dd
        is_dialog_only = yes
        response_text = roz_shinku_evt.701.dd.res
    }
    option = {
        name = roz_shinku_evt.701.ee
        is_dialog_only = yes
        response_text = roz_shinku_evt.701.ee.res
    }
    option = {
        name = roz_shinku_evt.701.ff
        #is_dialog_only = yes
        default_hide_option = yes
        response_text = roz_shinku_evt.701.ff.res
        custom_tooltip = roz_shinku_evt.701.ff.ct
    }

    after = {
        hidden_effect = {
            country_event = {
                id = roz_shinku_evt.702
                days = 1
            }
        }
    }
}

country_event = {
    id = roz_shinku_evt.702
    hide_window = yes
    is_triggered_only = yes
    trigger = {
        is_ai = no
    }
    immediate = {
        save_global_event_target_as = roz_shinku_owner@root
        set_country_flag = roz_shinku_commander_active
        set_country_flag = roz_leader_shinku_get
        create_country = {
            name = "NAME_nfield_sk"
            type = ge_N_Field
            flag = {
                icon = {
                    category = "nfield_sk_flags"
                    file = "flag_roz_sk.dds"
                }
                background = {
                    category = "backgrounds"
                    file = "inverted_v.dds"
                }
                colors = {
                    "black"
                    "black"
                    "null"
                    "null"
                }
            }
            effect = {
                save_global_event_target_as = roz_shinku_global_country@root
            }
        }
        last_created_country = {
            establish_communications_no_message = root
        }
        event_target:roz_shinku_global_country@root = { }
        create_leader = {
            class = commander
            name = "NAME_shinku"
            skill = 1
            gender = female
            species = owner_main_species
            immortal = yes
            event_leader = yes
            set_age = 17
            traits = {  }
            #randomize_traits = no
            hide_age = yes
            skip_background_generation = yes
            custom_catch_phrase = shinku_gov_catch_phrase
            custom_description = shinku_backstory
            effect = {
                add_skill_without_trait_selection = 2
                remove_all_traits = yes
                roz_leader_name_set_effect = {
                    who_jp = shinku
                    who_sc = zhenhong
                }
                change_leader_portrait = roz_shinku_20th
            }
        }
        last_created_leader = {
            save_global_event_target_as = roz_leader_shinku_global_target@root
            unassign_leader = this
            set_variable = {
                ##好感状态初始化
                which = roz_shinku_affection
                value = 5
            }
            add_trait = { trait = leader_trait_roz_shinku_main }
            random_list = {
                1 = { add_trait = { trait = leader_trait_armorer } }
                1 = { add_trait = { trait = leader_trait_military_overseer } }
                1 = { add_trait = { trait = leader_trait_master_gunner } }
                1 = { add_trait = { trait = leader_trait_destiny_engineer } }
                2 = { add_trait = { trait = leader_trait_guerilla_tactics } }
                1 = { add_trait = { trait = leader_trait_survivalist } }
                1 = { add_trait = { trait = leader_trait_maven_of_war } }
                1 = { add_trait = { trait = leader_trait_peacekeeper } }
            }
            random_list = {
                1 = { add_trait = { trait = leader_trait_taskmaster } }
                1 = { add_trait = { trait = leader_trait_fortress_cracker } }
                2 = { add_trait = { trait = leader_trait_chainbreaker } }
                1 = { add_trait = { trait = leader_trait_chainbreaker } }
                1 = { add_trait = { trait = leader_trait_honored_warmaster } }
                1 = { add_trait = { trait = leader_trait_academia_recruiter } }
                1 = { add_trait = { trait = leader_trait_supreme_warrior } }
                1 = { add_trait = { trait = leader_trait_spymaster } }
                1 = { add_trait = { trait = leader_trait_totalitarian } }
                1 = { add_trait = { trait = leader_trait_bellicose } }
            }
            freeze_leader_age = yes
            set_leader_flag = roz_shinku_flag
            set_leader_flag = legendary_leader
            set_leader_flag = immune_to_negative_traits
        }
        roz_leader_change_skin_set_flag_effect = {
            who = shinku
            portrait = roz_shinku
            flag = roz_shinku_portrait_change
            leader_flag = roz_shinku_flag
            portrait_key = roz_shinku_20th
        }
        clone_leader = {
            target = event_target:roz_leader_shinku_global_target@root
            effect = {
                save_global_event_target_as = roz_shinku_commander_inactive_temp@root
                #set_leader_flag = roz_shinku_flag
                set_name = NAME_shinku
                unassign_leader = this
                set_owner = event_target:roz_shinku_global_country@root
            }
        }
        set_timed_country_flag = { flag = roz_shinku_diplomatic_initialize_flag
        days = 31}
    }
}

########————真红：通讯界面和真红阶段茶会事件————#########

country_event = {   #真红通讯主界面
    id = roz_shinku_evt.1001
    is_triggered_only = yes
    diplomatic = yes
    picture_event_data = {
        room = roz_shinku_main_room
        portrait = event_target:ge_leader
    }
    event_window_type = leader_recruit

    title = roz_shinku_evt.1001.title
    ###正常好感度
    desc = {
        trigger = { check_variable = { which = roz_leader_aft_shinku_reduced_score value < 40 } }
        text = roz_shinku_evt.1001.desc_normal1
    }
    desc = {
        trigger = { check_variable = { which = roz_leader_aft_shinku_reduced_score value > 0 } }
        text = roz_shinku_evt.1001.desc_normal2
    }
    desc = {
        trigger = { check_variable = { which = roz_leader_aft_shinku_reduced_score value > 0 } }
        text = roz_shinku_evt.1001.desc_normal3
    }
    desc = {
        trigger = { check_variable = { which = roz_leader_aft_shinku_reduced_score value < 40 } }
        text = roz_shinku_evt.1001.desc_normal4
    }
    desc = {
        trigger = { check_variable = { which = roz_leader_aft_shinku_reduced_score value < 40 } }
        text = roz_shinku_evt.1001.desc_normal5
    }
    desc = {
        trigger = { check_variable = { which = roz_leader_aft_shinku_reduced_score value < 40 } }
        text = roz_shinku_evt.1001.desc_normal6
    }
    desc = {
        trigger = { check_variable = { which = roz_leader_aft_shinku_reduced_score value < 40 } }
        text = roz_shinku_evt.1001.desc_normal7
    }
    desc = {
        trigger = { check_variable = { which = roz_leader_aft_shinku_reduced_score value < 40 } }
        text = roz_shinku_evt.1001.desc_normal_hide
    }
    ##高好感度
    desc = {
        trigger = { check_variable = { which = roz_leader_aft_shinku_reduced_score value >= 40 } }
        text = roz_shinku_evt.1001.desc_aggressive1
    }
    desc = {
        trigger = { check_variable = { which = roz_leader_aft_shinku_reduced_score value >= 40 } }
        text = roz_shinku_evt.1001.desc_aggressive2
    }
    desc = {
        trigger = { check_variable = { which = roz_leader_aft_shinku_reduced_score value >= 40 } }
        text = roz_shinku_evt.1001.desc_aggressive3
    }
    desc = {
        trigger = { check_variable = { which = roz_leader_aft_shinku_reduced_score value >= 40 } }
        text = roz_shinku_evt.1001.desc_aggressive4
    }
    desc = {
        trigger = { check_variable = { which = roz_leader_aft_shinku_reduced_score value >= 40 } }
        text = roz_shinku_evt.1001.desc_aggressive5
    }
    desc = {
        trigger = { check_variable = { which = roz_leader_aft_shinku_reduced_score value >= 40 } }
        text = roz_shinku_evt.1001.desc_aggressive6
    }
    desc = {
        trigger = { check_variable = { which = roz_leader_aft_shinku_reduced_score value >= 40 } }
        text = roz_shinku_evt.1001.desc_aggressive7
    }
    desc = {
        trigger = { check_variable = { which = roz_leader_aft_shinku_reduced_score value >= 40 } }
        text = roz_shinku_evt.1001.desc_aggressive8
    }
    desc = {
        trigger = { check_variable = { which = roz_leader_aft_shinku_reduced_score value >= 40 } }
        text = roz_shinku_evt.1001.desc_aggressive9
    }
    desc = {
        trigger = { check_variable = { which = roz_leader_aft_shinku_reduced_score value >= 40 } }
        text = roz_shinku_evt.1001.desc_aggressive10
    }

    trigger = {
        NOT = {
            has_country_flag = ge_nfield_diplomacy_activated
        }
        from = {
            is_country_type = ge_N_Field
            is_same_value = event_target:roz_shinku_global_country@root
        }
    }
    immediate = {
        set_country_flag = ge_nfield_diplomacy_activated
        get_ge_leader_target = {
            flag = roz_shinku_flag
        }
    }   
    after = {
        if = {
            limit = {
                has_country_flag = ge_nfield_diplomacy_activated
            }
            remove_country_flag = ge_nfield_diplomacy_activated
        }
    }
    option = {  #换装
        name = roz_shinku_evt.1001.aa
    }
    option = {  #约会
        name = roz_shinku_evt.1001.bb
    }
    option = {  #行政官
        name = roz_shinku_evt.1001.cc
        trigger = {
            NOT = {
                has_country_flag = roz_shinku_official_active
            }
        }
        hidden_effect = {
            roz_shinku_leader_type_switch_official = yes
        }
        is_dialog_only = yes
        response_text = roz_shinku_evt.1001.cc.res1
        response_text = roz_shinku_evt.1001.cc.res2
        response_text = roz_shinku_evt.1001.cc.res3
        response_text = roz_shinku_evt.1001.cc.res4
    }
    option = {  #科学家
        name = roz_shinku_evt.1001.dd
        trigger = {
            NOT = {
                has_country_flag = roz_shinku_scientist_active
            }
        }
        hidden_effect = {
            roz_shinku_leader_type_switch_scientist = yes
        }
        is_dialog_only = yes
        response_text = roz_shinku_evt.1001.dd.res1
        response_text = roz_shinku_evt.1001.dd.res2
        response_text = roz_shinku_evt.1001.dd.res3
        response_text = roz_shinku_evt.1001.dd.res4
    }
    option = {  #指挥官
        name = roz_shinku_evt.1001.ee
        trigger = {
            NOT = {
                has_country_flag = roz_shinku_commander_active
            }
        }
        hidden_effect = {
            roz_shinku_leader_type_switch_commander = yes
        }
        is_dialog_only = yes
        response_text = roz_shinku_evt.1001.ee.res1
        response_text = roz_shinku_evt.1001.ee.res2
        response_text = roz_shinku_evt.1001.ee.res3
        response_text = roz_shinku_evt.1001.ee.res4
        response_text = roz_shinku_evt.1001.ee.res5
        response_text = roz_shinku_evt.1001.ee.res6
        response_text = roz_shinku_evt.1001.ee.res7
    }   
    option = {
        #退出
        name = roz_shinku_evt.1001.zz
        tag = dismiss_leader
        #tag = hire_leader
        default_hide_option = yes
        hidden_effect = {
            remove_country_flag = ge_nfield_diplomacy_activated
        }
    } 
    option = {
        #查询好感度
        name = roz_shinku_evt.1001.af
        response_text = roz_shinku_evt.1001.af.desc
        is_dialog_only = yes
        tag = hire_leader
    }
    
}












#############
#人偶师樱田纯通讯事件
country_event = {
    id = roz_shinku_evt.4001
    is_triggered_only = yes
    title = roz_shinku_evt.4001.title
    desc = roz_shinku_evt.4001.desc_1
    desc = roz_shinku_evt.4001.desc_2
    desc = roz_shinku_evt.4001.desc_3
    desc = roz_shinku_evt.4001.desc_4
    desc = roz_shinku_evt.4001.desc_5
    trigger = {
        has_country_flag = roz_shinku_story_start_flag
        NOR = {
            has_country_flag = ge_nfield_diplomacy_activated
            has_country_flag = roz_junn_dip_locked
        }
        from = { #是小纯缓存国家
            is_country_type = ge_N_Field
            is_same_value = event_target:roz_junn_global_country@root
            has_country_flag = roz_junn_country
        }
    }
    immediate = {
        set_country_flag = ge_nfield_diplomacy_activated
    }
    diplomatic = yes
    picture_event_data = {
         room = roz_junn_room
    }
    option = {
        name = roz_shinku_evt.4001.aa1
        response_text = roz_shinku_evt.4001.aa1.ct
        trigger = {
            NOT = { has_country_flag = roz_shinku_jtcl_end_flag }
        }
        is_dialog_only = yes
    }
    option = {
        name = roz_shinku_evt.4001.aa2
        response_text = roz_shinku_evt.4001.aa2.ct
        trigger = {
            has_country_flag = roz_shinku_jtcl_end_flag
        }
        is_dialog_only = yes
    }
    option = {
        name = roz_shinku_evt.4001.bb1
        response_text = roz_shinku_evt.4001.bb1.ct
        trigger = {
            NOT = { has_country_flag = roz_shinku_jtcl_end_flag }
        }
        is_dialog_only = yes
    }
    option = {
        name = roz_shinku_evt.4001.bb2
        response_text = roz_shinku_evt.4001.bb2.ct
        trigger = {
            has_country_flag = roz_shinku_jtcl_end_flag
        }
        is_dialog_only = yes
    }

    option = {
        name = roz_shinku_evt.4001.cc
        response_text = roz_shinku_evt.4001.cc.ct
        is_dialog_only = yes
    }

    option = {
        name = roz_shinku_evt.4001.dd1
        trigger = {
            NOT = { has_country_flag = roz_junn_dip_service_get }
        }
        hidden_effect = {
            set_country_flag = roz_junn_dip_service_get
            country_event = {
                id = roz_shinku_evt.4010
            }
            remove_country_flag = ge_nfield_diplomacy_activated
        }
    }
    option = {
        name = roz_shinku_evt.4001.dd2
        trigger = {
            has_country_flag = roz_junn_dip_service_get
        }
        hidden_effect = {
            country_event = {
                id = roz_shinku_evt.4010
            }
            remove_country_flag = ge_nfield_diplomacy_activated
        }
    }

    option = {
        name = roz_shinku_evt.4001.zz
    }

    after = {
        hidden_effect = {
            remove_country_flag = ge_nfield_diplomacy_activated
        }
    }
}

#
country_event = {
    id = roz_shinku_evt.4010
    is_triggered_only = yes
    title = roz_shinku_evt.4010.title
    desc = {
        text = roz_shinku_evt.4010.desc_1
        trigger = { NOT = { has_country_flag = roz_junn_dip_service_get } }
    }
    desc = {
        text = roz_shinku_evt.4010.desc_2
        trigger = { has_country_flag = roz_junn_dip_service_get }
    }
    diplomatic = yes
    picture_event_data = {
        room = roz_junn_room
    }
    option = {
        name = roz_shinku_evt.4010.aa
        custom_tooltip = roz_shinku_evt.4010.aa.ct
        trigger = {
            NOT = { has_country_flag = roz_rosa_mystica_enhance_flag }
            NOT = { has_special_project = roz_junn_rosa_flexible_employment }
        }
        enable_special_project = {
            name = roz_junn_rosa_flexible_employment
            owner = Root
        }
    }
    option = {
        name = roz_shinku_evt.4010.bb
        custom_tooltip = roz_shinku_evt.4010.bb.ct
    }
    option = {
        name = roz_shinku_evt.4010.zz
        fire_on_action = {
            on_action = on_custom_diplomacy
            scopes = {
                from = event_target:roz_junn_global_country@root
            }
        }
    }
}

country_event = {
    id = roz_shinku_evt.4011
    is_triggered_only = yes
    title = roz_shinku_evt.4011.title
    desc = roz_shinku_evt.4011.desc
    picture = GFX_evt_roz_rozen_party
    option = {
        name = roz_shinku_evt.4011.aa
        custom_tooltip = roz_shinku_evt.4011.ct
    }
    option = {
        name = roz_shinku_evt.4011.bb
        custom_tooltip = roz_shinku_evt.4011.ct
    }
}

country_event = {
    id = roz_shinku_evt.4012
    is_triggered_only = yes
    title = roz_shinku_evt.4012.title
    desc = roz_shinku_evt.4012.desc
    picture = GFX_evt_engineering_research
    option = {
        name = roz_shinku_evt.4012.aa
        custom_tooltip = roz_shinku_evt.4012.ct
    }
}
#############
#通讯界面：N之领域-雏莓
#真红苏醒前阶段的通讯界面
country_event = {
    id = roz_shinku_evt.4501
    is_triggered_only = yes
    title = roz_shinku_evt.4501.title
    desc = roz_shinku_evt.4501.desc_1
    desc = roz_shinku_evt.4501.desc_2
    desc = roz_shinku_evt.4501.desc_3
    desc = roz_shinku_evt.4501.desc_4
    desc = roz_shinku_evt.4501.desc_5
    desc = roz_shinku_evt.4501.desc_6
    desc = roz_shinku_evt.4501.desc_7
    desc = roz_shinku_evt.4501.desc_8
    trigger = {
        has_country_flag = roz_shinku_story_start_flag
        has_country_flag = roz_hinaichigo_arrive
        NOR = {
            has_country_flag = ge_nfield_diplomacy_activated
        }
        from = { #是雏莓缓存国家
            is_country_type = ge_N_Field
            is_same_value = event_target:roz_hinaichigo_global_country@root
            has_country_flag = roz_hinaichigo_country
        }
    }
    immediate = {
        set_country_flag = ge_nfield_diplomacy_activated
    }
    diplomatic = yes
    picture_event_data = {
        room = no_video_feed_room #TODO NEED REPLACE
    }
    option = {
        #立绘切换
        name = roz_shinku_evt.4501.aa
        response_text = roz_shinku_evt.4501.aa_ct
        is_dialog_only = yes
    }
    option = {
        name = roz_shinku_evt.4501.bb
        response_text = roz_shinku_evt.4501.bb_ct
        is_dialog_only = yes
    }

    option = {
        #嗯…算是约会吧
        #目前暂时只有一个
        name = roz_shinku_evt.4501.cc
        hidden_effect = {
            random_list = {
                1 = {country_event = { id = roz_shinku_evt.4601 days = 1 }}
            }
        }
    }

    option = {
        name = roz_shinku_evt.4501.dd
        response_text = roz_shinku_evt.4501.dd_ct
        trigger = {
            NOT = {  }
        }
        hidden_effect = {
        }
    }

    option = {
        name = roz_shinku_evt.4501.ee
        response_text = roz_shinku_evt.4501.ee_ct
    }

    after = {
        hidden_effect = {
            remove_country_flag = ge_nfield_diplomacy_activated
        }
    }
}

country_event = {
    id = roz_shinku_evt.4601
    is_triggered_only = yes
    title = roz_shinku_evt.4601.title
    desc = roz_shinku_evt.4601.desc
    trigger = {
        NOT = { has_country_flag = ge_nfield_diplomacy_activated }
    }
    immediate = {
        set_country_flag = ge_nfield_diplomacy_activated
    }
    diplomatic = yes
    picture_event_data = {
        room = no_video_feed_room #TODO NEED REPLACE
    }
    option = {
        name = roz_shinku_evt.4601.aa
        custom_tooltip = roz_shinku_evt.4601.aa.ct
    }
    option = {
        name = roz_shinku_evt.4601.bb
        custom_tooltip = roz_shinku_evt.4601.bb.ct
    }
    after = { hidden_effect = { remove_country_flag = ge_nfield_diplomacy_activated } }
}





